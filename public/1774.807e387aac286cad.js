"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[1774],{1774:(F,Z,o)=>{o.r(Z),o.d(Z,{FinancialPeriodModule:()=>it});var s=o(6814),p=o(2954),u=o(5861),g=function(a){return a.list="View Financial Periods",a.create="Create Financial Period",a.update="Edit Financial Period",a.delete="Delete Financial Period",a.exportPdf="View Financial Periods",a.exportCvs="View Financial Periods",a.import="View Financial Periods",a}(g||{});const d_api_create="financial-periods/create",d_api_get="financial-periods",d_api_getById="financial-periods/",d_api_update="financial-periods/update/",d_api_delete="financial-periods/",d_page_list="",d_page_view="view/:id",h=a=>{return{cols:[{field:"id",label:"id",class:""},{field:"title",label:"financial_year",class:""},{field:"start",label:"date_start",class:""},{field:"end",label:"date_end",class:""},{field:"status",label:"status",class:""},{field:"created_at",label:"created_at",class:""},{label:"action",actions:[{icon:"trash",class:"main-color",fun:(i=(0,u.Z)(function*(e){return yield a.financialService.delete(e,"delete journal")}),function(n){return i.apply(this,arguments)}),id:g.delete},{icon:"pen-to-square",class:"main-color",fun:function(){var i=(0,u.Z)(function*(e){return yield a.financialService.openDialogToUpdateFinancialPeriods(e)});return function(n){return i.apply(this,arguments)}}(),id:g.update}]}],Request:d_api_get};var i};var r=o(6924),b=o(5946),t=o(9291),f=o(6223),x=o(8645),A=o(8763),L=o(5118),C=o(3999),U=o(8614),P=o(3838),S=o(6098),M=o(1771),_=o(4779);function E(a,i){if(1&a&&(t.TgZ(0,"div",22),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.value," ")}}function I(a,i){if(1&a&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij(" ",null==e.serverValidation?null:e.serverValidation.start[0]," ")}}const j=function(){return{type:"name",length:3}};let D=(()=>{class a{constructor(e,n,l,c,v){this.fb=e,this.toaster=n,this.financialService=l,this.config=c,this.dialogRef=v,this.unsubscribe=new x.x,this.formGroup=this.initForm(),this.isLoading=!1,this.statuses=[{name:"Open",id:"open"},{name:"Closed",id:"closed"}],this.config.data?.data&&this.fillDataToUpdate()}reject(e){this.dialogRef.close(e)}initForm(){return this.fb.group({id:[Number],title:["",[f.kI.required]],status:["closed",[f.kI.required]],start:["",[f.kI.required]],end:["",[f.kI.required]]})}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():(this.isLoading=!0,this.config.data.data?this.financialService.update(this.formGroup.value).subscribe(e=>{this.toaster.success(e.message),this.dialogRef.close(!0)},e=>{this.toaster.error(e.error.message),this.errors=e.error.errors,this.isLoading=!1}):this.financialService.create(this.formGroup.value).subscribe(e=>{this.toaster.success(e.message),this.dialogRef.close(!0)},e=>{this.toaster.error(e.error.message),this.errors=e.error.errors,this.isLoading=!1}))}fillDataToUpdate(){this.formGroup.patchValue({id:this.config.data.data.id,title:this.config.data.data.title,status:this.config.data.data.status,start:this.config.data.data.start,end:this.config.data.data.end})}onDateChange(e){let n=e.split("-")[0],l=e.split("-")[0]=parseInt(n),c=new Date(l,11,31).toLocaleDateString("en-CA");this.formGroup.get("end")?.patchValue(c)}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(f.qu),t.Y36(A._W),t.Y36(T),t.Y36(L.S),t.Y36(L.E7))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-financial-form"]],decls:29,vars:37,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","assets/Tabs/Icon/Active/craete-bank.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[3,"formGroup","onSubmit"],["class","text-error",4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-12","col-md-6"],["text","financial_year","formControlName","title","ngDefaultControl","","placeholder","",3,"patternMessage","readOnly","type"],["ngDefaultControl","","formControlName","status",3,"text","data","placeholder","optionLabel","optionValue"],["ngDefaultControl","","formControlName","start",3,"disabled","text","optionLabel","placeholder","showIcon","onDateChange"],["class","error",4,"ngIf"],["ngDefaultControl","","formControlName","end",3,"disabled","text","optionLabel","placeholder","showIcon"],[1,"footer","d-flex","align-items-center","justify-content-between","my-3","gap-2"],[1,"cancel","w-100"],[1,"btn-cancel",3,"text","click"],[1,"create","w-100"],["translate","",3,"text","click"],[1,"text-error"],[1,"error"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"span",5),t.NdJ("click",function(){return n.reject(!1)}),t._UZ(6,"i",6),t.qZA()(),t.TgZ(7,"p",7),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"app-form",8),t.NdJ("onSubmit",function(){return n.accept()}),t.YNc(11,E,2,1,"div",9),t.ALo(12,"keyvalue"),t.TgZ(13,"div",10)(14,"div",11),t._UZ(15,"app-text",12),t.qZA(),t.TgZ(16,"div",11),t._UZ(17,"app-dropdown",13),t.qZA()(),t.TgZ(18,"div",10)(19,"div",11)(20,"app-date",14),t.NdJ("onDateChange",function(c){return n.onDateChange(c)}),t.qZA(),t.YNc(21,I,2,1,"p",15),t.qZA(),t.TgZ(22,"div",11),t._UZ(23,"app-date",16),t.qZA()(),t.TgZ(24,"div",17)(25,"div",18)(26,"app-button",19),t.NdJ("click",function(){return n.reject(!1)}),t.qZA()(),t.TgZ(27,"div",20)(28,"app-button",21),t.NdJ("click",function(){return n.accept()}),t.qZA()()()()()),2&e){let l;t.xp6(8),t.Oqu(t.lcZ(9,32,null!==(l=n.config.header)&&void 0!==l?l:"")),t.xp6(2),t.Q6J("formGroup",n.formGroup),t.xp6(1),t.Q6J("ngForOf",t.lcZ(12,34,n.errors)),t.xp6(4),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("patternMessage",t.DdM(36,j))("readOnly","update"==n.config.data.acceptLabel&&"closed"==n.config.data.data.status)("type","text"),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","status")("data",n.statuses)("placeholder","Status")("optionLabel","name")("optionValue","id"),t.xp6(3),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("disabled","update"==n.config.data.acceptLabel&&"closed"==n.config.data.data.status)("text","date_start")("optionLabel","Financial Year Start")("placeholder","date_start")("showIcon",!1),t.xp6(1),t.Q6J("ngIf",null==n.serverValidation?null:n.serverValidation.start),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("disabled","update"==n.config.data.acceptLabel&&"closed"==n.config.data.data.status)("text","date_end")("optionLabel","Financial Year End")("placeholder","date_end")("showIcon",!1),t.xp6(3),t.Q6J("text","Cancel"),t.xp6(2),t.Q6J("text",n.config.data.acceptLabel)}},dependencies:[s.sg,s.O5,C.Pi,U.T,P.J,S.I,M.U,f.Fj,f.JJ,f.JL,f.sg,f.u,_.r,s.Nd,C.X$],styles:["[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:12px}"]}),a})();var q=o(1732),J=o(3562);let T=(()=>{class a{constructor(e,n,l){this.http=e,this.dynamicDialog=n,this.toastr=l}getFinancialPeriods(e){return this.http.get(d_api_get)}getById(e){return this.http.get(d_api_getById+e)}openDialogToCreateFinancialPeriods(){var e=this;return(0,u.Z)(function*(){return yield e.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"create_new_financial_period",data:{acceptLabel:"Add",rejectLabel:"Cancel"},width:"480px",height:"auto"},D)})()}create(e){return this.http.post(d_api_create,e)}delete(e,n,l){var c=this;return(0,u.Z)(function*(){const v={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...e}},width:"480px",height:"auto"};if(!(yield c.dynamicDialog.confirm(v)))return!1;try{const y=yield c.http.delete(d_api_delete+e.id).toPromise();return c.toastr.success(y.message),y}catch(y){return c.toastr.error(y.error.message),y}})()}openDialogToUpdateFinancialPeriods(e,n,l){var c=this;return(0,u.Z)(function*(){const v={showHeader:!1,header:"update_financial_period",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...e}},height:"330px",width:"500px",styleClass:"financial-dialog"};return yield c.dynamicDialog.showDialogWithComponent(v,D)})()}update(e){return this.http.post(d_api_update+e.id,e)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(q.O),t.LFG(J.U),t.LFG(A._W))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var G=o(2377),w=o(359),R=o(5077),V=o(3826);let W=(()=>{class a{constructor(e){this.financialService=e,this.tableConfig=h(this),this.permissions=g,this.showImportForm=!1,this.isLoading=!1,this.financialFilterConfig=[{field:"search",label:"search",type:r.W.TEXT,placeholder:"search"},{field:"creator_id",label:"creator",type:r.W.SELECT,request:"user?limit=100",options:{label:"name",value:"id"}},{field:"status",label:"status",type:r.W.SELECT,data:[{name:"Open",id:"open"},{name:"Closed",id:"closed"}],options:{label:"name",value:"id"}},{field:"from",label:"from",type:r.W.DATE,placeholder:"From"},{field:"to",label:"to",type:r.W.DATE},{field:"start",label:"date_start",type:r.W.DATE,placeholder:"date_start"},{field:"end",label:"date_end",type:r.W.DATE,placeholder:"date_end"}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"created_at",field:"created_at"},{label:"title",field:"title"},{label:"status",field:"status"},{label:"id",field:"id"},{label:"creator",field:"creator_id"},{label:"date_start",field:" start"},{label:"date_end",field:"end"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:b.q.asc,field:b.q.asc},{label:b.q.desc,field:b.q.desc}]}],this.importError=[]}openDialogToCreateFinancialPeriods(){var e=this;return(0,u.Z)(function*(){(yield e.financialService.openDialogToCreateFinancialPeriods())&&(e.tableConfig=h(e))})()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list"]],decls:18,vars:9,consts:[[1,"page-card"],[1,"d-flex","justify-content-between","align-items-center"],[1,"title"],[1,"d-flex","align-items-center"],["text","new",3,"click"],[1,"d-flex","justify-content-between","my-3"],[3,"SortConfig"],["sort",""],[1,"d-flex","g-2"],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","filter","sort"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3)(6,"app-button",4),t.NdJ("click",function(){return n.openDialogToCreateFinancialPeriods()}),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"ukt-sort",6,7),t.TgZ(10,"div",8),t._UZ(11,"ukt-filter",9,10),t.qZA()(),t.TgZ(13,"div",11),t._UZ(14,"app-table",12),t.qZA(),t.TgZ(15,"div",13),t._UZ(16,"ukt-pagination",null,14),t.qZA()()),2&e){const l=t.MAs(9),c=t.MAs(12),v=t.MAs(17);t.xp6(3),t.Oqu(t.lcZ(4,7,"list_all_of_financial_period")),t.xp6(5),t.Q6J("SortConfig",n.sortConfig),t.xp6(3),t.Q6J("config",n.financialFilterConfig),t.xp6(3),t.Q6J("tableConfig",n.tableConfig)("pagination",v)("filter",c)("sort",l)}},dependencies:[G.a,w.Q,_.r,R.z,V.x,C.X$]}),a})(),N=(()=>{class a{constructor(e){this.financialService=e}resolve(e){return this.financialService.getById(e.params.id)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(T))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var Y=o(5219),B=o(9773);const z=[{path:d_page_list,component:W},{path:d_page_view,component:(()=>{class a{constructor(e,n,l){this.financialService=e,this.route=n,this.toastr=l,this.icon=Y.dv,this.unsubscribe=new x.x}ngOnInit(){this.route.data.pipe((0,B.R)(this.unsubscribe)).subscribe({next:e=>{this.data=e.financial.data},error:e=>{}})}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T),t.Y36(p.gz),t.Y36(A._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-view-financial"]],decls:66,vars:45,consts:[[1,"page-card"],[1,"title","d-flex","align-items-center"],["routerLink","/key/accounting/financial-period",1,"fa-solid","fa-arrow-left","me-2","pointer"],[1,""],[1,"sup-title"],[1,"module-selected-name"],[1,"page-title"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],["scope","col",1,"w-50"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"p",1),t._UZ(2,"i",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p",3)(6,"span",4),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"div",3)(11,"p",3)(12,"span",4),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"p",3)(17,"span",4),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._uU(20),t.qZA(),t.TgZ(21,"p",3)(22,"span",4),t._uU(23),t.ALo(24,"translate"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"p",3)(27,"span",4),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.qZA(),t.TgZ(32,"span",5),t._uU(33),t.qZA()()(),t.TgZ(34,"p",6),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"div",7)(38,"table",8)(39,"thead")(40,"tr")(41,"th",9),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"th",9),t._uU(45),t.ALo(46,"translate"),t.qZA()()(),t.TgZ(47,"tbody")(48,"tr")(49,"td"),t._uU(50),t.ALo(51,"translate"),t.qZA(),t.TgZ(52,"td"),t._uU(53),t.qZA()(),t.TgZ(54,"tr")(55,"td"),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"td"),t._uU(59),t.qZA()(),t.TgZ(60,"tr")(61,"td"),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.TgZ(64,"td"),t._uU(65),t.qZA()()()()()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,21,"financial_period")," "),t.xp6(4),t.Oqu(t.lcZ(8,23,"financial_year")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.title),""),t.xp6(4),t.Oqu(t.lcZ(14,25,"created_by")),t.xp6(2),t.hij(" "," : "+(null==n.data||null==n.data.creator?null:n.data.creator.name)," "),t.xp6(3),t.Oqu(t.lcZ(19,27,"date_start")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.start),""),t.xp6(3),t.Oqu(t.lcZ(24,29,"date_end")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.end),""),t.xp6(3),t.Oqu(t.lcZ(29,31,"status")),t.xp6(3),t.hij(" ",":"," "),t.xp6(2),t.Oqu(null==n.data?null:n.data.status),t.xp6(2),t.Oqu(t.lcZ(36,33,"activity_log")),t.xp6(7),t.Oqu(t.lcZ(43,35,"action")),t.xp6(3),t.Oqu(t.lcZ(46,37,"date")),t.xp6(5),t.Oqu(t.lcZ(51,39,"closed")),t.xp6(3),t.Oqu(null==n.data?null:n.data.end),t.xp6(3),t.Oqu(t.lcZ(57,41,"edited")),t.xp6(3),t.Oqu(null==n.data?null:n.data.updated_at),t.xp6(3),t.Oqu(t.lcZ(63,43,"created")),t.xp6(3),t.Oqu(null==n.data?null:n.data.created_at))},dependencies:[p.rH,C.X$],styles:["[_nghost-%COMP%]{font-size:1.6rem}[_nghost-%COMP%]   .table-responsive[_ngcontent-%COMP%]{margin-top:3rem;margin-bottom:5rem}[_nghost-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{background-color:var(--mainColor)!important;color:var(--white);font-size:14px;padding:10px}"]}),a})(),resolve:{financial:N}}];let X=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[p.Bz.forChild(z),p.Bz]}),a})();var K=o(1471),H=o(9293),$=o(9624),k=o(4413),tt=o(2115),et=o(1383),at=o(1890),nt=o(1019),ot=o(8096);let it=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[s.ez,X,et.m,C.aw,K.X,H.Q,$.U,tt.u,k.e,at.f,nt.i,ot.J,C.aw]}),a})()},1771:(F,Z,o)=>{o.d(Z,{U:()=>g});var s=o(9291),p=o(6223);const u=["*"];let g=(()=>{class d{constructor(){this.onSubmit=new s.vpe}ngOnChanges(r){}getFormData(){return"function"==typeof this.formData?this.formData(this.formGroup.value):{...this.formGroup.value}}reset(){this.formGroup.reset()}submit(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const r=this.getFormData();this.onSubmit.emit(r)}ngAfterContentInit(){}ngAfterContentChecked(){}ngOnDestroy(){}}return d.\u0275fac=function(r){return new(r||d)},d.\u0275cmp=s.Xpm({type:d,selectors:[["app-form"]],inputs:{formGroup:"formGroup",formData:"formData"},outputs:{onSubmit:"onSubmit"},features:[s.TTD],ngContentSelectors:u,decls:2,vars:1,consts:[[3,"formGroup","ngSubmit"]],template:function(r,m){1&r&&(s.F$t(),s.TgZ(0,"form",0),s.NdJ("ngSubmit",function(){return m.submit()}),s.Hsn(1),s.qZA()),2&r&&s.Q6J("formGroup",m.formGroup)},dependencies:[p._Y,p.JL,p.sg]}),d})()},9773:(F,Z,o)=>{o.d(Z,{R:()=>d});var s=o(9360),p=o(8251),u=o(4829),g=o(2420);function d(h){return(0,s.e)((r,m)=>{(0,u.Xf)(h).subscribe((0,p.x)(m,()=>m.complete(),g.Z)),!m.closed&&r.subscribe(m)})}}}]);