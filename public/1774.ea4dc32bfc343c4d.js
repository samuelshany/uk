"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[1774],{1774:(A,Z,o)=>{o.r(Z),o.d(Z,{FinancialPeriodModule:()=>lt});var s=o(6814),f=o(2954),m=o(5861),h=function(a){return a.list="View Financial Periods",a.create="Create Financial Period",a.update="Edit Financial Period",a.delete="Delete Financial Period",a.exportPdf="View Financial Periods",a.exportCvs="View Financial Periods",a.import="View Financial Periods",a}(h||{});const c_api_create="financial-periods/create",c_api_get="financial-periods",c_api_getById="financial-periods/",c_api_update="financial-periods/update/",c_api_delete="financial-periods/",c_page_list="",c_page_view="view/:id",v=a=>{return{cols:[{field:"id",label:"id",class:""},{field:"title",label:"financial_year",class:""},{field:"start",label:"date_start",class:""},{field:"end",label:"date_end",class:""},{field:"status",label:"status",class:"",custom_class_cel:i=>"open"==i.status?"text-active":"-"},{field:"created_at",label:"created_at",class:""},{label:"action",actions:[{icon:"trash",class:"main-color",fun:(i=(0,m.Z)(function*(e){return yield a.financialService.delete(e,"delete journal")}),function(n){return i.apply(this,arguments)}),id:h.delete},{icon:"pen-to-square",class:"main-color",fun:function(){var i=(0,m.Z)(function*(e){return yield a.financialService.openDialogToUpdateFinancialPeriods(e)});return function(n){return i.apply(this,arguments)}}(),id:h.update}]}],Request:c_api_get};var i};var d=o(6924),C=o(5946),t=o(9291),u=o(6223),F=o(8645),b=o(8763),D=o(5118),y=o(3999),G=o(8614),S=o(3838),P=o(6098),M=o(1771),L=o(4779),x=o(474);function q(a,i){if(1&a&&(t.TgZ(0,"p",26),t._uU(1),t.qZA()),2&a){const e=i.$implicit;t.xp6(1),t.hij(" ",e.value," ")}}function J(a,i){1&a&&t._UZ(0,"i",27)}function E(a,i){1&a&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"titlecase"),t.ALo(3,"translate"),t.qZA()),2&a&&(t.Tol("text-danger"),t.xp6(1),t.Oqu(t.lcZ(2,3,t.lcZ(3,5,"Required"))))}const I=function(){return{type:"name",length:3}};let O=(()=>{class a{constructor(e,n,r,l,p){this.fb=e,this.toaster=n,this.financialService=r,this.config=l,this.dialogRef=p,this.dates=[{name:"1-January",value:"-01-01"},{name:"1-July",value:"-07-01"}],this.unsubscribe=new F.x,this.formGroup=this.initForm(),this.isLoading=!1,this.statuses=[{name:"Open",id:"open"},{name:"Closed",id:"closed"}],this.config.data?.data&&this.fillDataToUpdate()}reject(e){this.dialogRef.close(e)}initForm(){return this.fb.group({id:[Number],title:["",[u.kI.required]],status:["closed",[u.kI.required]],start:["",[]],end:["",[u.kI.required]],start_month:["",[u.kI.required]],start_year:["",[u.kI.required]]})}onValueChange(e){const n=new Date(e).toLocaleDateString("en-CA");console.log(n.slice(0,4)),this.formGroup.get("start_year")?.patchValue(n.slice(0,4)),this.formGroup.get("start")?.patchValue(n.slice(0,4)),this.onDateChange()}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():(this.formGroup.get("start")?.patchValue(this.formGroup.get("start_year")?.value+this.formGroup.get("start_month")?.value),this.isLoading=!0,this.config.data.data?this.financialService.update(this.formGroup.value).subscribe(e=>{this.toaster.success(e.message),this.dialogRef.close(!0)},e=>{this.toaster.error(e.error.message),this.errors=e.error.errors,this.isLoading=!1}):(this.formGroup.patchValue(this.formGroup.get("start_month")?.value+this.formGroup.get("start_year")?.value),this.financialService.create(this.formGroup.value).subscribe(e=>{this.toaster.success(e.message),this.dialogRef.close(!0)},e=>{this.toaster.error(e.error.message),this.errors=e.error.errors,this.isLoading=!1})))}fillDataToUpdate(){this.formGroup.patchValue({id:this.config.data.data.id,title:this.config.data.data.title,status:this.config.data.data.status,start:this.config.data.data.start,end:this.config.data.data.end})}onDateChange(){if("-01-01"==this.formGroup.get("start_month")?.value&&this.formGroup.get("start_year")?.value){let e=new Date(this.formGroup.get("start_year")?.value,11,31).toLocaleDateString("en-CA");this.formGroup.get("end")?.patchValue(e)}else if("-07-01"==this.formGroup.get("start_month")?.value&&this.formGroup.get("start_year")?.value){let e=new Date(parseInt(this.formGroup.get("start_year")?.value)+1,5,30).toLocaleDateString("en-CA");this.formGroup.get("end")?.patchValue(e)}}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(u.qu),t.Y36(b._W),t.Y36(T),t.Y36(D.S),t.Y36(D.E7))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-financial-form"]],decls:37,vars:41,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","assets/Tabs/Icon/Active/craete-bank.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[3,"formGroup","onSubmit"],["class","text-error",4,"ngFor","ngForOf"],[1,"row"],[1,"col-sm-12","col-md-6"],["text","financial_year","formControlName","title","ngDefaultControl","","placeholder","",3,"patternMessage","readOnly","type"],["ngDefaultControl","","formControlName","status",3,"text","data","placeholder","optionLabel","optionValue"],["formControlName","start_month","optionLabel","name","optionValue","value",3,"text","data","onDropDownChange"],[1,"required-aster"],["class","fa-solid fa-asterisk",4,"ngIf"],["appendTo","body","formControlName","start_year","view","year","dateFormat","yy","inputId","yearpicker",3,"ngModel","onSelect","ngModelChange"],[3,"class",4,"ngIf"],[1,"col-sm-12","col-md-12"],["ngDefaultControl","","formControlName","end",3,"disabled","text","optionLabel","placeholder","showIcon"],[1,"footer","d-flex","align-items-center","justify-content-between","my-3","gap-2"],[1,"cancel","w-100"],[1,"btn-cancel",3,"text","click"],[1,"create","w-100"],["translate","",3,"text","click"],[1,"text-error"],[1,"fa-solid","fa-asterisk"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"span",5),t.NdJ("click",function(){return n.reject(!1)}),t._UZ(6,"i",6),t.qZA()(),t.TgZ(7,"p",7),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"app-form",8),t.NdJ("onSubmit",function(){return n.accept()}),t.YNc(11,q,2,1,"p",9),t.ALo(12,"keyvalue"),t.TgZ(13,"div",10)(14,"div",11),t._UZ(15,"app-text",12),t.qZA(),t.TgZ(16,"div",11),t._UZ(17,"app-dropdown",13),t.qZA()(),t.TgZ(18,"div",10)(19,"div",11)(20,"app-dropdown",14),t.NdJ("onDropDownChange",function(){return n.onDateChange()}),t.qZA()(),t.TgZ(21,"div",11)(22,"label"),t._uU(23),t.ALo(24,"titlecase"),t.ALo(25,"translate"),t.TgZ(26,"span",15),t.YNc(27,J,1,0,"i",16),t.qZA()(),t.TgZ(28,"p-calendar",17),t.NdJ("onSelect",function(l){return n.onValueChange(l)})("ngModelChange",function(l){return n.value=l}),t.qZA(),t.YNc(29,E,4,7,"p",18),t.qZA(),t.TgZ(30,"div",19),t._UZ(31,"app-date",20),t.qZA()(),t.TgZ(32,"div",21)(33,"div",22)(34,"app-button",23),t.NdJ("click",function(){return n.reject(!1)}),t.qZA()(),t.TgZ(35,"div",24)(36,"app-button",25),t.NdJ("click",function(){return n.accept()}),t.qZA()()()()()),2&e){let r,l,p;t.xp6(8),t.Oqu(t.lcZ(9,32,null!==(r=n.config.header)&&void 0!==r?r:"")),t.xp6(2),t.Q6J("formGroup",n.formGroup),t.xp6(1),t.Q6J("ngForOf",t.lcZ(12,34,n.errors)),t.xp6(4),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("patternMessage",t.DdM(40,I))("readOnly","update"==n.config.data.acceptLabel&&"closed"==n.config.data.data.status)("type","text"),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","status")("data",n.statuses)("placeholder","Status")("optionLabel","name")("optionValue","id"),t.xp6(3),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","start_month")("data",n.dates),t.xp6(3),t.hij("",t.lcZ(24,36,t.lcZ(25,38,"start_year"))," "),t.xp6(4),t.Q6J("ngIf",null==(l=n.formGroup.get("start_year"))||null==l.errors?null:l.errors.required),t.xp6(1),t.Q6J("ngModel",n.value),t.xp6(1),t.Q6J("ngIf",(null==(p=n.formGroup.get("start_year"))?null:p.errors)&&((null==(p=n.formGroup.get("start_year"))?null:p.touched)||n.formGroup.dirty)),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("disabled",!0)("text","date_end")("optionLabel","Financial Year End")("placeholder","date_end")("showIcon",!1),t.xp6(3),t.Q6J("text","Cancel"),t.xp6(2),t.Q6J("text",n.config.data.acceptLabel)}},dependencies:[s.sg,s.O5,y.Pi,G.T,S.J,P.I,M.U,u.Fj,u.JJ,u.JL,u.sg,u.u,L.r,x.f,s.rS,s.Nd,y.X$],styles:["[_nghost-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:12px}"]}),a})();var j=o(1732),w=o(3562);let T=(()=>{class a{constructor(e,n,r){this.http=e,this.dynamicDialog=n,this.toastr=r}getFinancialPeriods(e){return this.http.get(c_api_get)}getById(e){return this.http.get(c_api_getById+e)}openDialogToCreateFinancialPeriods(){var e=this;return(0,m.Z)(function*(){return yield e.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"create_new_financial_period",data:{acceptLabel:"Add",rejectLabel:"Cancel"},width:"480px",height:"auto"},O)})()}create(e){return this.http.post(c_api_create,e)}delete(e,n,r){var l=this;return(0,m.Z)(function*(){const p={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...e}},width:"480px",height:"auto"};if(!(yield l.dynamicDialog.confirm(p)))return!1;try{const _=yield l.http.delete(c_api_delete+e.id).toPromise();return l.toastr.success(_.message),_}catch(_){return l.toastr.error(_.error.message),_}})()}openDialogToUpdateFinancialPeriods(e,n,r){var l=this;return(0,m.Z)(function*(){const p={showHeader:!1,header:"update_financial_period",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...e}},height:"330px",width:"500px",styleClass:"financial-dialog"};return yield l.dynamicDialog.showDialogWithComponent(p,O)})()}update(e){return this.http.post(c_api_update+e.id,e)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(j.O),t.LFG(w.U),t.LFG(b._W))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var V=o(2377),N=o(359),R=o(5077),W=o(3826);let Q=(()=>{class a{constructor(e){this.financialService=e,this.tableConfig=v(this),this.permissions=h,this.showImportForm=!1,this.isLoading=!1,this.financialFilterConfig=[{field:"search",label:"search",type:d.W.TEXT,placeholder:"search"},{field:"creator_id",label:"creator",type:d.W.SELECT,request:"user?limit=100",options:{label:"name",value:"id"}},{field:"status",label:"status",type:d.W.SELECT,data:[{name:"Open",id:"open"},{name:"Closed",id:"closed"}],options:{label:"name",value:"id"}},{field:"from",label:"from",type:d.W.DATE,placeholder:"From"},{field:"to",label:"to",type:d.W.DATE},{field:"start",label:"date_start",type:d.W.DATE,placeholder:"date_start"},{field:"end",label:"date_end",type:d.W.DATE,placeholder:"date_end"}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"created_at",field:"created_at"},{label:"title",field:"title"},{label:"status",field:"status"},{label:"id",field:"id"},{label:"creator",field:"creator_id"},{label:"date_start",field:" start"},{label:"date_end",field:"end"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:C.q.asc,field:C.q.asc},{label:C.q.desc,field:C.q.desc}]}],this.importError=[]}openDialogToCreateFinancialPeriods(){var e=this;return(0,m.Z)(function*(){(yield e.financialService.openDialogToCreateFinancialPeriods())&&(e.tableConfig=v(e))})()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list"]],decls:18,vars:9,consts:[[1,"page-card"],[1,"d-flex","justify-content-between","align-items-center"],[1,"title"],[1,"d-flex","align-items-center"],["text","new",3,"click"],[1,"d-flex","justify-content-between","my-3"],[3,"SortConfig"],["sort",""],[1,"d-flex","g-2"],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","filter","sort"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3)(6,"app-button",4),t.NdJ("click",function(){return n.openDialogToCreateFinancialPeriods()}),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"ukt-sort",6,7),t.TgZ(10,"div",8),t._UZ(11,"ukt-filter",9,10),t.qZA()(),t.TgZ(13,"div",11),t._UZ(14,"app-table",12),t.qZA(),t.TgZ(15,"div",13),t._UZ(16,"ukt-pagination",null,14),t.qZA()()),2&e){const r=t.MAs(9),l=t.MAs(12),p=t.MAs(17);t.xp6(3),t.Oqu(t.lcZ(4,7,"list_all_of_financial_period")),t.xp6(5),t.Q6J("SortConfig",n.sortConfig),t.xp6(3),t.Q6J("config",n.financialFilterConfig),t.xp6(3),t.Q6J("tableConfig",n.tableConfig)("pagination",p)("filter",l)("sort",r)}},dependencies:[V.a,N.Q,L.r,R.z,W.x,y.X$]}),a})(),Y=(()=>{class a{constructor(e){this.financialService=e}resolve(e){return this.financialService.getById(e.params.id)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(T))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var B=o(5219),z=o(9773);const K=[{path:c_page_list,component:Q},{path:c_page_view,component:(()=>{class a{constructor(e,n,r){this.financialService=e,this.route=n,this.toastr=r,this.icon=B.dv,this.unsubscribe=new F.x}ngOnInit(){this.route.data.pipe((0,z.R)(this.unsubscribe)).subscribe({next:e=>{this.data=e.financial.data},error:e=>{}})}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T),t.Y36(f.gz),t.Y36(b._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-view-financial"]],decls:66,vars:45,consts:[[1,"page-card"],[1,"title","d-flex","align-items-center"],["routerLink","/key/accounting/financial-period",1,"fa-solid","fa-arrow-left","me-2","pointer"],[1,""],[1,"sup-title"],[1,"module-selected-name"],[1,"page-title"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],["scope","col",1,"w-50"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"p",1),t._UZ(2,"i",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p",3)(6,"span",4),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"div",3)(11,"p",3)(12,"span",4),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._uU(15),t.qZA(),t.TgZ(16,"p",3)(17,"span",4),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._uU(20),t.qZA(),t.TgZ(21,"p",3)(22,"span",4),t._uU(23),t.ALo(24,"translate"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"p",3)(27,"span",4),t._uU(28),t.ALo(29,"translate"),t.qZA(),t.TgZ(30,"span"),t._uU(31),t.qZA(),t.TgZ(32,"span",5),t._uU(33),t.qZA()()(),t.TgZ(34,"p",6),t._uU(35),t.ALo(36,"translate"),t.qZA(),t.TgZ(37,"div",7)(38,"table",8)(39,"thead")(40,"tr")(41,"th",9),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"th",9),t._uU(45),t.ALo(46,"translate"),t.qZA()()(),t.TgZ(47,"tbody")(48,"tr")(49,"td"),t._uU(50),t.ALo(51,"translate"),t.qZA(),t.TgZ(52,"td"),t._uU(53),t.qZA()(),t.TgZ(54,"tr")(55,"td"),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"td"),t._uU(59),t.qZA()(),t.TgZ(60,"tr")(61,"td"),t._uU(62),t.ALo(63,"translate"),t.qZA(),t.TgZ(64,"td"),t._uU(65),t.qZA()()()()()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,21,"financial_period")," "),t.xp6(4),t.Oqu(t.lcZ(8,23,"financial_year")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.title),""),t.xp6(4),t.Oqu(t.lcZ(14,25,"created_by")),t.xp6(2),t.hij(" "," : "+(null==n.data||null==n.data.creator?null:n.data.creator.name)," "),t.xp6(3),t.Oqu(t.lcZ(19,27,"date_start")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.start),""),t.xp6(3),t.Oqu(t.lcZ(24,29,"date_end")),t.xp6(2),t.hij(" "," : "+(null==n.data?null:n.data.end),""),t.xp6(3),t.Oqu(t.lcZ(29,31,"status")),t.xp6(3),t.hij(" ",":"," "),t.xp6(2),t.Oqu(null==n.data?null:n.data.status),t.xp6(2),t.Oqu(t.lcZ(36,33,"activity_log")),t.xp6(7),t.Oqu(t.lcZ(43,35,"action")),t.xp6(3),t.Oqu(t.lcZ(46,37,"date")),t.xp6(5),t.Oqu(t.lcZ(51,39,"closed")),t.xp6(3),t.Oqu(null==n.data?null:n.data.end),t.xp6(3),t.Oqu(t.lcZ(57,41,"edited")),t.xp6(3),t.Oqu(null==n.data?null:n.data.updated_at),t.xp6(3),t.Oqu(t.lcZ(63,43,"created")),t.xp6(3),t.Oqu(null==n.data?null:n.data.created_at))},dependencies:[f.rH,y.X$],styles:["[_nghost-%COMP%]{font-size:1.6rem}[_nghost-%COMP%]   .table-responsive[_ngcontent-%COMP%]{margin-top:3rem;margin-bottom:5rem}[_nghost-%COMP%]   .table-responsive[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{background-color:var(--mainColor)!important;color:var(--white);font-size:14px;padding:10px}"]}),a})(),resolve:{financial:Y}}];let k=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[f.Bz.forChild(K),f.Bz]}),a})();var H=o(1471),$=o(9293),tt=o(9624),et=o(4413),at=o(2115),nt=o(1383),ot=o(1890),it=o(1019),rt=o(8096);let lt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[s.ez,k,nt.m,y.aw,H.X,$.Q,tt.U,at.u,et.e,ot.f,it.i,rt.J,y.aw,x._8]}),a})()},1771:(A,Z,o)=>{o.d(Z,{U:()=>h});var s=o(9291),f=o(6223);const m=["*"];let h=(()=>{class c{constructor(){this.onSubmit=new s.vpe}ngOnChanges(d){}getFormData(){return"function"==typeof this.formData?this.formData(this.formGroup.value):{...this.formGroup.value}}reset(){this.formGroup.reset()}submit(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const d=this.getFormData();this.onSubmit.emit(d)}ngAfterContentInit(){}ngAfterContentChecked(){}ngOnDestroy(){}}return c.\u0275fac=function(d){return new(d||c)},c.\u0275cmp=s.Xpm({type:c,selectors:[["app-form"]],inputs:{formGroup:"formGroup",formData:"formData"},outputs:{onSubmit:"onSubmit"},features:[s.TTD],ngContentSelectors:m,decls:2,vars:1,consts:[[3,"formGroup","ngSubmit"]],template:function(d,g){1&d&&(s.F$t(),s.TgZ(0,"form",0),s.NdJ("ngSubmit",function(){return g.submit()}),s.Hsn(1),s.qZA()),2&d&&s.Q6J("formGroup",g.formGroup)},dependencies:[f._Y,f.JL,f.sg]}),c})()},9773:(A,Z,o)=>{o.d(Z,{R:()=>c});var s=o(9360),f=o(8251),m=o(4829),h=o(2420);function c(v){return(0,s.e)((d,g)=>{(0,m.Xf)(v).subscribe((0,f.x)(g,()=>g.complete(),h.Z)),!g.closed&&d.subscribe(g)})}}}]);