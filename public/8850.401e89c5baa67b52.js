"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[8850],{68:(v,h,n)=>{n.d(h,{a:()=>i});const i={api:{create:"account/create",get:"account/with-group/all",getNotParent:"not-parents/accounts",getParent:"parents/accounts",getProfitLossParent:"profit-loss/parent-accounts",getExpensesParent:"account/parent/expenses",getAssetsParent:"account/parent/assets",getById:"account/",update:"account/update/",delete:"account/",exportExample:"account/export/example",exportExampleSub:"account/export/example/sub",export:"account/export/parent",exportPdf:"account/export/pdf",importAccount:"account/import",importAccountSub:"account/import/sub"},page:{}}},8850:(v,h,n)=>{n.r(h),n.d(h,{SafeAccountModule:()=>tt});var i=n(6814),b=n(8209),t=n(9291),f=n(5861),p=function(o){return o.list="View Accounts",o.create="Create Account",o.update="Edit Account",o.delete="Delete Account",o.import="Import Accounts",o.export="Export Accounts",o}(p||{}),m=n(6924),g=n(5946);const d_api_create="account/create",d_api_get="account?is_safe=1",d_api_update="account/update/",d_api_delete="account/",d_api_exportExample="account/export/example",d_api_export="account/export/parent",d_api_importAccount="account/import",C=o=>{return{cols:[{field:"code",label:"code",class:""},{field:"name",label:"name",class:""},{field:"group",label:"account_group",class:""},{field:"parent",label:"account_parent",format:a=>a.parent?a.parent:"-"},{field:"total_debit",label:"balance_debit",format:a=>a.total_credit?a.total_credit:"0"},{field:"total_credit",label:"balance_credit",format:a=>a.total_credit?a.total_credit:"0"},{field:"account_type",label:"account_type",format:a=>a.account_type?a.account_type:"-"},{label:"action",actions:[{id:p.delete,icon:"trash",class:"main-color",fun:(a=(0,f.Z)(function*(e){return yield o.safeAccountService.delete(e,"delete account")}),function(c){return a.apply(this,arguments)})},{id:p.update,icon:"pen-to-square",class:"main-color",fun:function(){var a=(0,f.Z)(function*(e){return yield o.safeAccountService.openDialogToUpdate(e)});return function(c){return a.apply(this,arguments)}}()}]}],Request:d_api_get,titleRow:"name_code"};var a};var L=n(68),J=n(8645),s=n(6223),S=n(8763),T=n(5118),x=n(3999),F=n(1771),U=n(8614),N=n(1904),G=n(3838),Z=n(4779);function E(o,a){if(1&o&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.hij(" ",e.value," ")}}let _=(()=>{class o{constructor(e,c,r,A,l){this.fb=e,this.toastr=c,this.config=r,this.dialogRef=A,this.safeAccountService=l,this.accountConfig=L.a,this.unsubscribe=new J.x,this.formGroup=this.initForm(),this.types=[{name:"Both",id:"both"},{name:"Credit",id:"credit"},{name:"Debit",id:"debit"}],this.config.data?.data&&this.fillDataToUpdate()}ngOnInit(){}initForm(){return this.fb.group({id:[Number],name:["",[s.kI.required]],opening_balance_debit:[0,[s.kI.required,s.kI.pattern("^[0-9.]+$")]],opening_balance_credit:[0,[s.kI.required,s.kI.pattern("^[0-9.]+$")]],account_type:["both",s.kI.required],parent_code:["",s.kI.required],is_parent:[0],is_safe:[1]})}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():this.config.data.data?this.safeAccountService.update(this.formGroup.value).subscribe(e=>{this.toastr.success(e.message),this.ClosePopUp(!0)},e=>{this.errors=e.error.errors}):this.safeAccountService.addAccount(this.formGroup.value).subscribe(e=>{this.toastr.success(e.message),this.ClosePopUp(!0)},e=>{this.errors=e.error.errors})}ClosePopUp(e){this.dialogRef.close(e)}fillDataToUpdate(){this.formGroup.patchValue({id:this.config.data.data.id,name:this.config.data.data.name,parent_code:this.config.data?.data?.parent_code,account_type:this.config.data.data?.account_type,opening_balance_debit:this.config.data.data?.opening_balance_debit,opening_balance_credit:this.config.data.data?.opening_balance_credit})}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.qu),t.Y36(S._W),t.Y36(T.S),t.Y36(T.E7),t.Y36(D))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-new-safe-account"]],decls:30,vars:35,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","assets/Tabs/Icon/Active/craete-bank.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[1,"form"],[3,"formGroup","onSubmit"],["class","text-error",4,"ngFor","ngForOf"],["text","name","formControlName","name","ngDefaultControl","","placeholder","",3,"type"],[1,"row"],[1,"col-12","my-3"],["ngDefaultControl","","formControlName","parent_code",3,"filter","text","request","optionLabel","optionValue","placeholder"],["ngDefaultControl","","placeholder","","formControlName","opening_balance_debit",1,"d-block",3,"showButtons","mode","text"],["ngDefaultControl","","placeholder","","formControlName","opening_balance_credit",1,"d-block",3,"showButtons","mode","text"],["ngDefaultControl","","formControlName","account_type",3,"text","data","optionLabel","optionValue","placeholder"],[1,"footer","row","g-2","my-3"],[1,"cancel","col-6"],[1,"btn-cancel",3,"text","click"],[1,"create","col-6"],["translate","",3,"text","click"],[1,"text-error"]],template:function(e,c){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"span",5),t.NdJ("click",function(){return c.ClosePopUp(!1)}),t._UZ(6,"i",6),t.qZA()(),t.TgZ(7,"p",7),t._uU(8),t.ALo(9,"titlecase"),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"div",8)(12,"app-form",9),t.NdJ("onSubmit",function(){return c.accept()}),t.YNc(13,E,2,1,"p",10),t.ALo(14,"keyvalue"),t._UZ(15,"app-text",11),t.TgZ(16,"div",12)(17,"div",13),t._UZ(18,"app-dropdown",14),t.qZA()(),t.TgZ(19,"div",13),t._UZ(20,"app-number-input",15),t.qZA(),t.TgZ(21,"div",13),t._UZ(22,"app-number-input",16),t.qZA(),t.TgZ(23,"div",13),t._UZ(24,"app-dropdown",17),t.qZA()(),t.TgZ(25,"div",18)(26,"div",19)(27,"app-button",20),t.NdJ("click",function(){return c.ClosePopUp(!1)}),t.qZA()(),t.TgZ(28,"div",21)(29,"app-button",22),t.NdJ("click",function(){return c.accept()}),t.qZA()()()()()),2&e){let r;t.xp6(8),t.Oqu(t.lcZ(9,29,t.lcZ(10,31,null!==(r=c.config.header)&&void 0!==r?r:""))),t.xp6(4),t.Q6J("formGroup",c.formGroup),t.xp6(1),t.Q6J("ngForOf",t.lcZ(14,33,c.errors)),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("type","text"),t.xp6(3),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("filter",!0)("text","parent")("request","groups-accounts")("optionLabel","name_code")("optionValue","code")("placeholder","select"),t.xp6(2),t.Q6J("showButtons",!1)("mode","currency")("text","opening_balance_debit"),t.xp6(2),t.Q6J("showButtons",!1)("mode","currency")("text","opening_balance_credit"),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","account_type")("data",c.types)("optionLabel","name")("optionValue","id")("placeholder","select"),t.xp6(3),t.Q6J("text","Cancel"),t.xp6(2),t.Q6J("text",c.config.data.acceptLabel)}},dependencies:[i.sg,x.Pi,F.U,s.Fj,s.JJ,s.JL,s.sg,s.u,U.T,N.D,G.J,Z.r,i.rS,i.Nd,x.X$]}),o})();var P=n(1732),I=n(3562);let D=(()=>{class o{constructor(e,c,r){this.http=e,this.dynamicDialog=c,this.toastr=r}getAccounts(e){return this.http.get(d_api_get)}openDialogToCreate(e){return this.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"add_safe_account",data:{acceptLabel:"Add",rejectLabel:"Cancel"},width:"500px",height:"auto"},_)}addAccount(e){return this.http.post(d_api_create,e)}exportExample(){return this.http.get(d_api_exportExample)}export(){return this.http.get(d_api_export)}delete(e){var c=this;return(0,f.Z)(function*(){const r={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...e},name:"name"},width:"480px",height:"164px"};if(!(yield c.dynamicDialog.confirm(r)))return!1;try{const l=yield c.http.delete(d_api_delete+e.id).toPromise();return c.toastr.success(l.message),l}catch(l){return c.toastr.error(l.error.message),l}})()}openDialogToUpdate(e,c,r){var A=this;return(0,f.Z)(function*(){const l={showHeader:!1,header:"update_account",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...e}},width:"480px",height:"auto"};return yield A.dynamicDialog.showDialogWithComponent(l,_)})()}update(e){return this.http.post(d_api_update+e.id,e)}importAccount(e){return this.http.post(d_api_importAccount,e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(P.O),t.LFG(I.U),t.LFG(S._W))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var O=n(8275),Q=n(2377),j=n(359),M=n(5077),w=n(3826);function B(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"app-button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.createAccount())}),t.qZA()}2&o&&t.Q6J("text","new")}const W=function(o){return[o]};let Y=(()=>{class o{constructor(e){this.safeAccountService=e,this.tableConfig=C(this),this.filtersConfig=[{field:"search",label:"search",type:m.W.TEXT,placeholder:"search"},{field:"account_type",label:"Account type",type:m.W.TEXT,placeholder:"Type"},{field:"from",label:"From",type:m.W.DATE,placeholder:"From"},{field:"to",label:"To",type:m.W.DATE}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"name",field:"name"},{label:"code",field:"code"},{label:"account_group",field:"group"},{label:"account_type",field:"account_type"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:g.q.asc,field:g.q.asc},{label:g.q.desc,field:g.q.desc}]}],this.permissions=p}createAccount(){var e=this;return(0,f.Z)(function*(){(yield e.safeAccountService.openDialogToCreate())&&(e.tableConfig=C(e))})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list-safe-accounts"]],decls:19,vars:14,consts:[[1,"page-card"],[1,"d-flex","justify-content-between","pb-5"],[1,"title"],[1,"d-flex","gap-2","align-items-center"],[3,"text","click",4,"hasPermissions"],[1,"d-flex","justify-content-between"],[3,"SortConfig"],["sort",""],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","filter","sort"],["table",""],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""],[3,"text","click"]],template:function(e,c){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"titlecase"),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",3),t.YNc(7,B,1,1,"app-button",4),t.qZA()(),t.TgZ(8,"div",5),t._UZ(9,"ukt-sort",6,7)(11,"ukt-filter",8,9),t.qZA(),t.TgZ(13,"div",10),t._UZ(14,"app-table",11,12),t.qZA(),t.TgZ(16,"div",13),t._UZ(17,"ukt-pagination",null,14),t.qZA()()),2&e){const r=t.MAs(10),A=t.MAs(12),l=t.MAs(18);t.xp6(3),t.Oqu(t.lcZ(4,8,t.lcZ(5,10,"safe_accounts"))),t.xp6(4),t.Q6J("hasPermissions",t.VKq(12,W,c.permissions.create)),t.xp6(2),t.Q6J("SortConfig",c.sortConfig),t.xp6(2),t.Q6J("config",c.filtersConfig),t.xp6(3),t.Q6J("tableConfig",c.tableConfig)("pagination",l)("filter",A)("sort",r)}},dependencies:[O.z,Q.a,j.Q,Z.r,M.z,w.x,i.rS,x.X$]}),o})();const R=[{path:"",component:(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-safe-account"]],decls:1,vars:0,template:function(e,c){1&e&&t._UZ(0,"app-list-safe-accounts")},dependencies:[Y]}),o})()}];let V=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[b.Bz.forChild(R),b.Bz]}),o})();var X=n(1383),k=n(1471),z=n(2115),$=n(4413),H=n(1890),K=n(1019),q=n(8096);let tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[i.ez,V,X.m,x.aw,k.X,z.u,$.e,H.f,K.i,q.J]}),o})()},1771:(v,h,n)=>{n.d(h,{U:()=>f});var i=n(9291),b=n(6223);const t=["*"];let f=(()=>{class p{constructor(){this.onSubmit=new i.vpe}ngOnChanges(u){}getFormData(){return"function"==typeof this.formData?this.formData(this.formGroup.value):{...this.formGroup.value}}reset(){this.formGroup.reset()}submit(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const u=this.getFormData();this.onSubmit.emit(u)}ngAfterContentInit(){}ngAfterContentChecked(){}ngOnDestroy(){}}return p.\u0275fac=function(u){return new(u||p)},p.\u0275cmp=i.Xpm({type:p,selectors:[["app-form"]],inputs:{formGroup:"formGroup",formData:"formData"},outputs:{onSubmit:"onSubmit"},features:[i.TTD],ngContentSelectors:t,decls:2,vars:1,consts:[[3,"formGroup","ngSubmit"]],template:function(u,g){1&u&&(i.F$t(),i.TgZ(0,"form",0),i.NdJ("ngSubmit",function(){return g.submit()}),i.Hsn(1),i.qZA()),2&u&&i.Q6J("formGroup",g.formGroup)},dependencies:[b._Y,b.JL,b.sg]}),p})()}}]);