"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[8687],{8687:(T,m,n)=>{n.r(m),n.d(m,{StocksModule:()=>ct});var s=n(6814),g=n(8209),d=n(5861),h=function(o){return o.create="Create Stock",o.update="Edit Stock",o.delete="Delete Stock",o.view="View Stock",o}(h||{});const l_api_create="stock/create",l_api_get="stock",l_api_update="stock/update/",l_api_delete="stock/",l_api_getProducts="product",v=o=>{return{cols:[{field:"id",label:"code",class:""},{field:"product",label:"product",format:i=>i.product?.name??"",class:""},{field:"opening_stock",label:"opening_stock",class:""},{field:"quantity",label:"quantity",format:i=>i.quantity?i.quantity:"0"},{field:"warehouse",label:"warehouse",format:i=>i.warehouse?.name??"",class:""},{field:"purchasing_price",label:"purchase_price",class:""},{field:"selling_price",label:"selling_price",class:""},{label:"action",actions:[{id:h.delete,icon:"trash",class:"main-color",fun:(i=(0,d.Z)(function*(e){return yield o.stockService.delete(e)}),function(r){return i.apply(this,arguments)})},{id:h.update,icon:"pen-to-square",class:"main-color",fun:function(){var i=(0,d.Z)(function*(e){return yield o.stockService.openDialogToUpdate(e)});return function(r){return i.apply(this,arguments)}}()}]}],Request:l_api_get};var i};var u=n(5219),c=n(5946),C=n(6924),A=n(8718),t=n(9291),p=n(6223),L=n(8645),U=n(9773),J=n(6017),O=n(3058),Z=n(8763),b=n(5118),I=n(1771),w=n(8614),E=n(3838),G=n(6098),S=n(4779),_=n(3999);function P(o,i){if(1&o&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.financial_period[0])}}function M(o,i){if(1&o&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.product_id[0])}}function N(o,i){if(1&o&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.opening_stock[0])}}function j(o,i){if(1&o&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.quantity[0])}}function q(o,i){if(1&o&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.warehouse_id[0])}}function Q(o,i){if(1&o&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.purchasing_price[0])}}function Y(o,i){if(1&o&&(t.TgZ(0,"p",23),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(null==e.errors?null:e.errors.selling_price[0])}}let k=(()=>{class o{constructor(e,r,a,x,f){this.fb=e,this.toastr=r,this.config=a,this.dialogRef=x,this.stockService=f,this.unsubscribe=new L.x,this.formGroup=this.initForm(),this.wrehouseConfig=J.Y,this.productConfig=O.s,this.products=[],this.billingCities=[],this.config.data?.data&&this.fillDataToUpdate()}ngOnInit(){this.stockService.getProducts().pipe((0,U.R)(this.unsubscribe)).subscribe({next:e=>{this.products=e.data}})}initForm(){return this.fb.group({id:[Number],product_id:["",[p.kI.required]],opening_stock:["",[p.kI.required]],selling_price:["",[p.kI.required]],purchasing_price:["",[p.kI.required]],quantity:["",[p.kI.required]],warehouse_id:["",[p.kI.required]]})}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():this.config.data.data?this.stockService.update(this.formGroup.value).subscribe({next:e=>{this.toastr.success(e.message),this.reject(!0)},error:e=>{this.errors=e.error.errors}}):this.stockService.create(this.formGroup.value).subscribe({next:e=>{this.toastr.success(e.message),this.reject(!0)},error:e=>{this.errors=e.error.errors}})}reject(e){this.dialogRef.close(e)}fillDataToUpdate(){this.formGroup.patchValue({id:this.config.data.data.id,product_id:this.config.data.data.product_id,opening_stock:this.config.data.data.opening_stock,selling_price:this.config.data.data.selling_price,purchasing_price:this.config.data.data.purchasing_price,quantity:this.config.data.data.quantity,warehouse_id:this.config.data.data.warehouse_id})}getProduct(e){let r=e.value;this.product=this.products.filter(a=>a.id==r)[0],this.product.selling_price&&this.formGroup.get("selling_price")?.patchValue(this.product.selling_price),this.product.purchase_price&&this.formGroup.get("purchasing_price")?.patchValue(this.product.purchase_price)}ngOnDestroy(){this.unsubscribe.next(!0),this.unsubscribe.complete()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.qu),t.Y36(Z._W),t.Y36(b.S),t.Y36(b.E7),t.Y36(D))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-stock-form"]],decls:36,vars:41,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","assets/Tabs/Icon/Active/inventory-icon.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[3,"formGroup","onSubmit"],["class","text-error",4,"ngIf"],[1,"row"],[1,"col-12"],["ngDefaultControl","","formControlName","product_id",3,"text","data","optionLabel","optionValue","placeholder","onDropDownChange"],["text","date","formControlName","opening_stock","ngDefaultControl","","placeholder",""],["class","messageError",4,"ngIf"],["text","quantity","formControlName","quantity","ngDefaultControl","","placeholder",""],["ngDefaultControl","","formControlName","warehouse_id",3,"text","request","optionLabel","optionValue","placeholder"],["ngDefaultControl","","formControlName","purchasing_price",3,"text","placeholder"],["text","selling_price","formControlName","selling_price","ngDefaultControl","","placeholder",""],[1,"row","g-2","my-2"],[1,"col-6"],[3,"text","click"],[1,"text-error"],[1,"messageError"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"span",5),t.NdJ("click",function(){return r.reject(!1)}),t._UZ(6,"i",6),t.qZA()(),t.TgZ(7,"p",7),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"app-form",8),t.NdJ("onSubmit",function(){return r.accept()}),t.YNc(11,P,2,1,"p",9),t.TgZ(12,"div",10)(13,"div",11)(14,"app-dropdown",12),t.NdJ("onDropDownChange",function(x){return r.getProduct(x)}),t.qZA(),t.YNc(15,M,2,1,"p",9),t.qZA(),t.TgZ(16,"div",11),t._UZ(17,"app-date",13),t.YNc(18,N,2,1,"p",14),t.qZA(),t.TgZ(19,"div",11),t._UZ(20,"app-text",15),t.YNc(21,j,2,1,"p",14),t.qZA(),t.TgZ(22,"div",11),t._UZ(23,"app-dropdown",16),t.YNc(24,q,2,1,"p",9),t.qZA(),t.TgZ(25,"div",11),t._UZ(26,"app-text",17),t.YNc(27,Q,2,1,"p",9),t.qZA(),t.TgZ(28,"div",11),t._UZ(29,"app-text",18),t.YNc(30,Y,2,1,"p",14),t.qZA()(),t.TgZ(31,"div",19)(32,"div",20)(33,"app-button",21),t.NdJ("click",function(){return r.reject(!1)}),t.qZA()(),t.TgZ(34,"div",20)(35,"app-button",21),t.NdJ("click",function(){return r.accept()}),t.qZA()()()()()),2&e){let a;t.xp6(8),t.Oqu(t.lcZ(9,39,null!==(a=r.config.header)&&void 0!==a?a:"")),t.xp6(2),t.Q6J("formGroup",r.formGroup),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.financial_period),t.xp6(3),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","product")("data",r.products)("optionLabel","name")("optionValue","id")("placeholder","select"),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.product_id),t.xp6(2),t.Tol("d-flex flex-column justify-content-between mt-2"),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.opening_stock),t.xp6(2),t.Tol("d-flex flex-column justify-content-between mt-2"),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.quantity),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","warehouse")("request",r.wrehouseConfig.api.get)("optionLabel","name")("optionValue","id")("placeholder","warehouse"),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.warehouse_id),t.xp6(2),t.Tol("d-flex flex-column justify-content-between"),t.Q6J("text","purchase_price")("placeholder",""),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.purchasing_price),t.xp6(2),t.Tol("d-flex flex-column justify-content-between mt-2"),t.xp6(1),t.Q6J("ngIf",null==r.errors?null:r.errors.selling_price),t.xp6(3),t.Tol("btn-cancel"),t.Q6J("text","cancel"),t.xp6(2),t.Tol("btn-filter"),t.Q6J("text",null==r.config.data?null:r.config.data.acceptLabel)}},dependencies:[s.O5,I.U,p.Fj,p.JJ,p.JL,p.sg,p.u,w.T,E.J,G.I,S.r,_.X$]}),o})();var W=n(1732),R=n(3562);let D=(()=>{class o{constructor(e,r,a){this.http=e,this.dynamicDialog=r,this.toastr=a}getProducts(e){return this.http.getWithParam(l_api_getProducts,{limit:"all"})}openDialogToCreate(){return this.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"add_stock",data:{acceptLabel:"add",rejectLabel:"cancel"},width:"500px",height:"auto"},k)}create(e){return this.http.post(l_api_create,e)}delete(e){var r=this;return(0,d.Z)(function*(){const a={showHeader:!0,header:"delete_stock",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...e}},width:"300px",height:"auto"};if(yield r.dynamicDialog.confirm(a))try{const f=yield r.http.delete(l_api_delete+e.id).toPromise();return r.toastr.success(f.message),f}catch(f){throw r.toastr.error(f.error.message),f}return!1})()}openDialogToUpdate(e){var r=this;return(0,d.Z)(function*(){const a={showHeader:!1,header:"update_stock",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...e}},width:"500px",height:"auto"};return yield r.dynamicDialog.showDialogWithComponent(a,k)})()}update(e){return this.http.post(l_api_update+e.id,e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(W.O),t.LFG(R.U),t.LFG(Z._W))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var B=n(2377),V=n(359),K=n(5077),X=n(4811),z=n(8275);function H(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"app-button",14),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openDialogToCreate())}),t.qZA()}if(2&o){const e=t.oxw();t.Tol("btn-filter"),t.Q6J("text","new")("icon",e.icon.PLUS)("iconPos","left")}}const $=function(o){return[o]},tt=[{path:"",component:(()=>{class o{constructor(e){this.stockService=e,this.tableConfig=v(this),this.reloadData=!1,this.permissions=h,this.icon=u.dv,this.filtersConfig=[{field:"search",label:"search",type:C.W.TEXT,placeholder:"search"},{field:"creator_id",label:"created_by",type:C.W.SELECT,options:{value:"id",label:"name"},request:A.x.api.get,placeholder:"select"},{field:"from",label:"from",type:C.W.DATE},{field:"to",label:"to",type:C.W.DATE}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"Name",field:"name"},{label:"id",field:"id"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:c.q.asc,field:c.q.asc},{label:c.q.desc,field:c.q.desc}]}]}openDialogToCreate(){var e=this;return(0,d.Z)(function*(){(yield e.stockService.openDialogToCreate())&&(e.tableConfig=v(e))})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list"]],decls:17,vars:12,consts:[[1,"page-card"],[1,"d-flex","align-items-center","justify-content-between"],[1,"title"],[1,"d-flex"],[3,"text","class","icon","iconPos","click",4,"hasPermissions"],[1,"d-flex","flex-row","align-items-center","justify-content-between"],[3,"SortConfig"],["sort",""],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","filter","sort"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""],[3,"text","icon","iconPos","click"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3),t.YNc(6,H,1,5,"app-button",4),t.qZA()(),t.TgZ(7,"div",5),t._UZ(8,"ukt-sort",6,7)(10,"ukt-filter",8,9),t.qZA(),t.TgZ(12,"div",10),t._UZ(13,"app-table",11),t.qZA(),t.TgZ(14,"div",12),t._UZ(15,"ukt-pagination",null,13),t.qZA()()),2&e){const a=t.MAs(9),x=t.MAs(11),f=t.MAs(16);t.xp6(3),t.Oqu(t.lcZ(4,8,"list_of_stocks")),t.xp6(3),t.Q6J("hasPermissions",t.VKq(10,$,r.permissions.create)),t.xp6(2),t.Q6J("SortConfig",r.sortConfig),t.xp6(2),t.Q6J("config",r.filtersConfig),t.xp6(3),t.Q6J("tableConfig",r.tableConfig)("pagination",f)("filter",x)("sort",a)}},dependencies:[B.a,V.Q,S.r,K.z,X.x,z.z,_.X$]}),o})()}];let et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.Bz.forChild(tt),g.Bz]}),o})();var ot=n(1471),nt=n(2115),rt=n(4413),it=n(1890),at=n(1019),st=n(8096),lt=n(1383);let ct=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[s.ez,et,ot.X,nt.u,rt.e,it.f,at.i,st.J,_.aw,lt.m]}),o})()},1771:(T,m,n)=>{n.d(m,{U:()=>h});var s=n(9291),g=n(6223);const d=["*"];let h=(()=>{class l{constructor(){this.onSubmit=new s.vpe}ngOnChanges(u){}getFormData(){return"function"==typeof this.formData?this.formData(this.formGroup.value):{...this.formGroup.value}}reset(){this.formGroup.reset()}submit(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const u=this.getFormData();this.onSubmit.emit(u)}ngAfterContentInit(){}ngAfterContentChecked(){}ngOnDestroy(){}}return l.\u0275fac=function(u){return new(u||l)},l.\u0275cmp=s.Xpm({type:l,selectors:[["app-form"]],inputs:{formGroup:"formGroup",formData:"formData"},outputs:{onSubmit:"onSubmit"},features:[s.TTD],ngContentSelectors:d,decls:2,vars:1,consts:[[3,"formGroup","ngSubmit"]],template:function(u,c){1&u&&(s.F$t(),s.TgZ(0,"form",0),s.NdJ("ngSubmit",function(){return c.submit()}),s.Hsn(1),s.qZA()),2&u&&s.Q6J("formGroup",c.formGroup)},dependencies:[g._Y,g.JL,g.sg]}),l})()},8718:(T,m,n)=>{n.d(m,{x:()=>s});const s={api:{create:"user/create",get:"user",getById:"user/",update:"user/update/",delete:"user/",exportCvs:"user/export/cvs",exportPdf:"user/export/pdf",import:"user/import",export:"user/data/export"},page:{list:"",view:"view/:id"}}},9773:(T,m,n)=>{n.d(m,{R:()=>l});var s=n(9360),g=n(8251),d=n(4829),h=n(2420);function l(v){return(0,s.e)((u,c)=>{(0,d.Xf)(v).subscribe((0,g.x)(c,()=>c.complete(),h.Z)),!c.closed&&u.subscribe(c)})}}}]);