"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[6962],{6962:(G,g,i)=>{i.r(g),i.d(g,{ReceiptsInvoicesModule:()=>re});var r=i(6814),f=i(2954);const c_api_get="purchase?type=vendor",c_api_getById="purchase/",c_api_update="purchase/update/",c_api_delete="purchase/",c_api_getBills="purchase/",c_page_list="",c_page_details="details/:id",c_page_collect="collect/:id",c_page_payment="payment/:id";var v=i(5861),p=function(o){return o.create="Create Purchase",o.view="View Purchases",o.edit="Edit Purchase",o.delete="Delete Purchase",o}(p||{});const h=o=>{return{cols:[{field:"id",label:"#Invoice ",class:""},{field:"product_name",label:"product_name"},{field:"quantity",label:"quantity"},{field:"supplier_name",label:"supplier"},{field:"total",label:"total_amount"},{field:"date",label:"date"},{field:"status",label:"status",custom_class_cel:a=>"paid"==a.status?"status-approved":"status-pending",class:"text-center"},{label:"action",actions:[{id:p.edit,icon:"fa-solid fa-eye",class:"main-color",route:"details"},{id:p.edit,icon:"fa-solid fa-money-check-dollar",class:"main-color",fun:(a=(0,v.Z)(function*(t){return yield o.receiptsInvoicesService.openDialogToSelectPaymentMethod(t)}),function(n){return a.apply(this,arguments)})},{id:p.edit,icon:"fa-solid fa-sack-dollar",class:"fa-solid main-color",route:"collect"}]}],data:[{id:1,product_name:"test",quantity:23,supplier_name:"hamada",total:1200,date:"21-12-2032",status:"Pending"}]};var a};var Z=i(6924),y=i(5946),D=i(5219),e=i(9291),d=i(6223),T=i(8763),C=i(5118),q=i(1771),F=i(8614),J=i(1904),L=i(3838),M=i(6098),O=i(4779),I=i(474),A=i(3999);function S(o,a){if(1&o&&(e.TgZ(0,"p",7),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,"total_invoices")," : ",t.totalInvoicesAmount," ")}}function E(o,a){if(1&o&&(e.TgZ(0,"p",18),e._uU(1),e.ALo(2,"titlecase"),e.ALo(3,"translate"),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,e.lcZ(3,3,t.messageError)),"")}}function N(o,a){if(1&o&&(e.TgZ(0,"div")(1,"p",19),e._uU(2),e.qZA()()),2&o){const t=a.$implicit;e.xp6(2),e.hij(" ",t.value,"")}}function w(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"div",24)(2,"label",25),e._uU(3),e.ALo(4,"titlecase"),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"app-text",26),e.qZA(),e.TgZ(7,"div",24)(8,"label",25),e._uU(9),e.ALo(10,"titlecase"),e.ALo(11,"translate"),e.qZA(),e._UZ(12,"app-text",26),e.qZA(),e.TgZ(13,"div",27)(14,"p",28),e.NdJ("click",function(){const m=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.deleteInvoiceFromDetailsArray(m))}),e._UZ(15,"i",29),e.qZA()()()}if(2&o){const t=a.$implicit,n=a.index;e.xp6(3),e.AsE("",e.lcZ(4,16,e.lcZ(5,18,"date"))," ",n+1,""),e.xp6(3),e.Tol("d-flex flex-column justify-content-between"),e.Q6J("value",t.value.date)("readOnly",!0)("text","")("placeholder",""),e.xp6(3),e.AsE("",e.lcZ(10,20,e.lcZ(11,22,"amount"))," ",n+1,""),e.xp6(3),e.Tol("d-flex flex-column justify-content-between"),e.Q6J("value",t.value.amount)("readOnly",!0)("text","")("placeholder","")}}function Q(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",12),e._UZ(2,"app-date",31),e.qZA(),e.TgZ(3,"div",12),e._UZ(4,"p-calendar",32)(5,"app-number-input",33),e.qZA(),e.TgZ(6,"div",27)(7,"p",5),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.addInvoiceToDetailsArray())}),e._UZ(8,"i",34),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Tol("d-flex flex-column justify-content-between"),e.Q6J("text","date"),e.xp6(2),e.Q6J("showIcon",!0)("minDate",t.minDate),e.xp6(1),e.Tol("d-flex flex-column justify-content-between"),e.Q6J("showButtons",!1)("mode","currency")("text","amount")("placeholder","")}}function B(o,a){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,w,16,24,"div",21),e.YNc(2,Q,9,11,"div",22),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.detailsInvoices.controls),e.xp6(1),e.Q6J("ngIf",t.totalInvoicesAmount<t.total_amount)}}let x=(()=>{class o{constructor(t,n,s,m,l){this.fb=t,this.toastr=n,this.config=s,this.dialogRef=m,this.receiptsInvoicesService=l,this.messageError="",this.formGroup=this.initForm(),this.totalInvoicesAmount=0,this.paymentTypes=[{name:"cash",id:"cash"},{name:"credit",id:"credit"}],this.disabledDates=[new Date("2023-12-25"),new Date("2023-12-26")],this.minDate=new Date,this.config.data?.data&&this.fillData(this.config.data?.data)}initForm(){return this.fb.group({id:[Number],payment_method:["cash",[d.kI.required]],details:this.fb.array([]),invoice:this.fb.group({date:["",d.kI.required],amount:["",d.kI.required]})})}get detailsInvoices(){return this.formGroup.get("details")}fillData(t){this.total_amount=t.total,this.formGroup.get("id")?.patchValue(t.id)}accept(){this.formGroup.get("invoice.date")?.clearValidators(),this.formGroup.get("invoice.date")?.updateValueAndValidity(),this.formGroup.get("invoice.amount")?.clearValidators(),this.formGroup.get("invoice.amount")?.updateValueAndValidity(),"credit"==this.formGroup.get("payment_method")?.value?this.totalInvoicesAmount==this.total_amount?this.formGroup.invalid?this.formGroup.markAllAsTouched():this.receiptsInvoicesService.selectPaymentMethod(this.formGroup.value).subscribe({next:t=>{this.toastr.success(t.message),this.closePopup(!0)},error:t=>{this.errors=t.error.errors,this.toastr.error(t.error.message)}}):this.messageError="total_invoices not equal total_amount":this.formGroup.invalid?this.formGroup.markAllAsTouched():this.receiptsInvoicesService.selectPaymentMethod(this.formGroup.value).subscribe({next:t=>{this.toastr.success(t.message),this.closePopup(!0)},error:t=>{this.errors=t.error.errors,this.toastr.error(t.error.message)}})}closePopup(t){this.dialogRef.close(t)}addInvoiceToDetailsArray(){this.formGroup.get("invoice")?.invalid?this.formGroup.get("invoice")?.markAllAsTouched():(this.detailsInvoices.push(this.fb.group({date:this.formGroup.get("invoice")?.value.date,amount:this.formGroup.get("invoice")?.value.amount})),this.totalInvoicesAmount+=parseInt(this.formGroup.get("invoice")?.value.amount),this.clearInvoiceForm())}deleteInvoiceFromDetailsArray(t){this.detailsInvoices.controls.forEach((n,s)=>{s==t&&(this.totalInvoicesAmount-=parseInt(n.value.amount))}),this.detailsInvoices.removeAt(t)}clearInvoiceForm(){("credit"==this.formGroup.get("payment_method")?.value||this.totalInvoicesAmount==this.total_amount)&&(this.messageError=""),this.formGroup.get("invoice")?.reset()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d.qu),e.Y36(T._W),e.Y36(C.S),e.Y36(C.E7),e.Y36(b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-receipts-invoices"]],decls:26,vars:28,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","../assets/Tabs/Icon/Active/purchase -2.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],["class","title",4,"ngIf"],[3,"formGroup"],["class","text-error text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"my-3"],["formControlName","payment_method",3,"filter","text","data","optionLabel","optionValue","placeholder"],["class","credit",4,"ngIf"],[1,"row","g-2","my-2"],[1,"col-6"],[3,"text","click"],[1,"text-error","text-center"],[1,"text-error"],[1,"credit"],["formArrayName","details","class","group",4,"ngFor","ngForOf"],["formGroupName","invoice","class","group",4,"ngIf"],["formArrayName","details",1,"group"],[1,"my-2"],["for",""],[3,"value","readOnly","text","placeholder"],[1,"action"],[1,"text-danger",3,"click"],[1,"fa-solid","fa-trash"],["formGroupName","invoice",1,"group"],["ngDefaultControl","","formControlName","date",3,"text"],["inputId","icon",3,"showIcon","minDate"],["formControlName","amount",3,"showButtons","mode","text","placeholder"],[1,"fa-solid","fa-check"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._UZ(4,"img",4),e.qZA(),e.TgZ(5,"span",5),e.NdJ("click",function(){return n.closePopup(!1)}),e._UZ(6,"i",6),e.qZA()(),e.TgZ(7,"p",7),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"p",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,S,3,4,"p",8),e.qZA(),e.TgZ(14,"app-form",9),e.YNc(15,E,4,5,"p",10),e.YNc(16,N,3,1,"div",11),e.ALo(17,"keyvalue"),e.TgZ(18,"div",12),e._UZ(19,"app-dropdown",13),e.qZA(),e.YNc(20,B,3,2,"div",14),e.TgZ(21,"div",15)(22,"div",16)(23,"app-button",17),e.NdJ("click",function(){return n.closePopup(!1)}),e.qZA()(),e.TgZ(24,"div",16)(25,"app-button",17),e.NdJ("click",function(){return n.accept()}),e.qZA()()()()()),2&t){let s,m,l,R;e.xp6(8),e.Oqu(e.lcZ(9,22,null!==(s=n.config.header)&&void 0!==s?s:"")),e.xp6(3),e.AsE("",e.lcZ(12,24,"total_amount")," : ",n.total_amount," "),e.xp6(2),e.Q6J("ngIf","credit"==(null==(m=n.formGroup.get("payment_method"))?null:m.value)),e.xp6(1),e.Q6J("formGroup",n.formGroup),e.xp6(1),e.Q6J("ngIf","credit"==(null==(l=n.formGroup.get("payment_method"))?null:l.value)),e.xp6(1),e.Q6J("ngForOf",e.lcZ(17,26,n.errors)),e.xp6(3),e.Tol(""),e.Q6J("filter",!0)("text","payment_method")("data",n.paymentTypes)("optionLabel","name")("optionValue","id")("placeholder","cash"),e.xp6(1),e.Q6J("ngIf","credit"==(null==(R=n.formGroup.get("payment_method"))?null:R.value)),e.xp6(3),e.Tol("btn-cancel"),e.Q6J("text","Cancel"),e.xp6(2),e.Tol("btn-filter"),e.Q6J("text",null==n.config.data?null:n.config.data.acceptLabel)}},dependencies:[r.sg,r.O5,q.U,d.Fj,d.JJ,d.JL,d.sg,d.u,d.x0,d.CE,F.T,J.D,L.J,M.I,O.r,I.f,r.rS,r.Nd,A.X$],styles:[".main[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.main[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17px;margin-top:20px;margin-inline-end:30px;cursor:pointer}"]}),o})();var j=i(1732),Y=i(3562);let b=(()=>{class o{constructor(t,n,s){this.http=t,this.dynamicDialog=n,this.toastr=s}get(){return this.http.get(c_api_get)}getById(t){return this.http.get(c_api_getById+t)}delete(t){var n=this;return(0,v.Z)(function*(){const s={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...t}},width:"480px",height:"auto"};if(!(yield n.dynamicDialog.confirm(s)))return!1;try{const l=yield n.http.delete(c_api_delete+t.id).toPromise();return n.toastr.success(l.message),l}catch(l){return n.toastr.error(l.error.message),l}})()}openDialogToSelectPaymentMethod(t){var n=this;return(0,v.Z)(function*(){const s={showHeader:!1,header:"payment_method",data:{acceptLabel:"submit",rejectLabel:"Cancel",data:{...t}},height:"auto",width:"500px",styleClass:"financial-dialog"};return yield n.dynamicDialog.showDialogWithComponent(s,x)})()}selectPaymentMethod(t){return this.http.post(c_api_update+t.id,t)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(j.O),e.LFG(Y.U),e.LFG(T._W))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var U=i(2377),V=i(359),X=i(5077),z=i(3826);const H=[{path:c_page_list,component:(()=>{class o{constructor(t){this.receiptsInvoicesService=t,this.tableConfig=h(this),this.filtersConfig=[{field:"search",label:"search",type:Z.W.TEXT,placeholder:"search"}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"Name",field:"name"},{label:"code",field:"code"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:y.q.asc,field:y.q.asc},{label:y.q.desc,field:y.q.desc}]}],this.permissions=p,this.icon=D.dv}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-list-receipts-invoices"]],decls:15,vars:9,consts:[[1,"page-card"],[1,"d-flex","align-items-center","justify-content-between"],[1,"title"],[1,"d-flex","flex-row","align-items-center","justify-content-between"],[3,"SortConfig"],["sort",""],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","sort","filter"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",3),e._UZ(6,"ukt-sort",4,5)(8,"ukt-filter",6,7),e.qZA(),e.TgZ(10,"div",8),e._UZ(11,"app-table",9),e.qZA(),e.TgZ(12,"div",10),e._UZ(13,"ukt-pagination",null,11),e.qZA()()),2&t){const s=e.MAs(7),m=e.MAs(9),l=e.MAs(14);e.xp6(3),e.Oqu(e.lcZ(4,7,"purchase_request_list")),e.xp6(3),e.Q6J("SortConfig",n.sortConfig),e.xp6(2),e.Q6J("config",n.filtersConfig),e.xp6(3),e.Q6J("tableConfig",n.tableConfig)("pagination",l)("sort",s)("filter",m)}},dependencies:[U.a,V.Q,X.z,z.x,A.X$]}),o})()},{path:c_page_payment,component:x},{path:c_page_details,component:(()=>{class o{constructor(){this.tableConfig={cols:[{field:"Bill",label:"Bill",class:""},{field:"due_date",label:"due_date"},{field:"due_amount",label:"due_amount"},{field:"status",label:"status",class:"",custom_class_cel:a=>"open"==a.status?"text-active":"-"},{label:"action"}],Request:c_api_getBills}}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-details-receipts-invoices"]],decls:79,vars:1,consts:[[1,"p-5","bg-white"],[1,"d-flex"],[1,"pi","pi-arrow-left","px-3","pt-2",2,"font-size","2rem"],[1,"fw-bold","fs-1"],[1,"row","mt-5"],[1,"col-4"],[1,"p-2","rounded-5","detail"],[1,"p-4"],[1,"fw-bold","mb-4","fs-2"],[1,"invisible"],[1,"mt-5","p-2","rounded-5","detail"],[1,"row","mt-3"],[1,"col"],[1,"m-0"],[1,"m-0","pt-1"],[1,"fw-bold","fs-1","mt-5","px-4"],[1,"table"],[3,"tableConfig"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"h2",3),e._uU(4,"invoice_details"),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"h3",8),e._uU(10,"supplier_contact"),e.qZA(),e.TgZ(11,"p"),e._uU(12,"Name here"),e.qZA(),e.TgZ(13,"p"),e._uU(14,"Mail@mail.com"),e.qZA(),e.TgZ(15,"p"),e._uU(16,"0123456789"),e.qZA(),e.TgZ(17,"p",9),e._uU(18,"0123456789"),e.qZA()()()(),e.TgZ(19,"div",5)(20,"div",6)(21,"div",7)(22,"h3",8),e._uU(23,"billing_info"),e.qZA(),e.TgZ(24,"p"),e._uU(25,"Billing Info"),e.qZA(),e.TgZ(26,"p"),e._uU(27,"Address here"),e.qZA(),e.TgZ(28,"p"),e._uU(29,"Egypt"),e.qZA(),e.TgZ(30,"p"),e._uU(31,"0123456789"),e.qZA()()()(),e.TgZ(32,"div",5)(33,"div",6)(34,"div",7)(35,"h3",8),e._uU(36,"shipping_info"),e.qZA(),e.TgZ(37,"p"),e._uU(38,"Billing Info"),e.qZA(),e.TgZ(39,"p"),e._uU(40,"Address here"),e.qZA(),e.TgZ(41,"p"),e._uU(42,"Egypt"),e.qZA(),e.TgZ(43,"p"),e._uU(44,"0123456789"),e.qZA()()()()(),e.TgZ(45,"div",10)(46,"div",7)(47,"h3",8),e._uU(48,"product_info"),e.qZA(),e.TgZ(49,"div",11)(50,"div",12)(51,"p",13),e._uU(52,"product_id"),e.qZA(),e.TgZ(53,"p",14),e._uU(54,"#POD00001"),e.qZA()(),e.TgZ(55,"div",12)(56,"p",13),e._uU(57,"quantity"),e.qZA(),e.TgZ(58,"p",14),e._uU(59,"5"),e.qZA()(),e.TgZ(60,"div",12)(61,"p",13),e._uU(62,"date_of_creation"),e.qZA(),e.TgZ(63,"p",14),e._uU(64,"Jul 21, 2021"),e.qZA()(),e.TgZ(65,"div",12)(66,"p",13),e._uU(67,"unit_price"),e.qZA(),e.TgZ(68,"p",14),e._uU(69,"$123,720.00"),e.qZA()(),e.TgZ(70,"div",12)(71,"p",13),e._uU(72,"total_amount"),e.qZA(),e.TgZ(73,"p",14),e._uU(74,"$123,720.00"),e.qZA()()()()(),e.TgZ(75,"h2",15),e._uU(76,"Bills"),e.qZA(),e.TgZ(77,"div",16),e._UZ(78,"app-table",17),e.qZA()()),2&t&&(e.xp6(78),e.Q6J("tableConfig",n.tableConfig))},dependencies:[U.a],styles:[".detail[_ngcontent-%COMP%]{background-color:var(--lightGray)}.detail[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500}"]}),o})()},{path:c_page_collect,component:(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-collect-receipts-invoices"]],decls:2,vars:0,template:function(t,n){1&t&&(e.TgZ(0,"p"),e._uU(1,"collect-receipts-invoices works!"),e.qZA())}}),o})()}];let K=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.Bz.forChild(H),f.Bz]}),o})();var ee=i(1471),te=i(2115),oe=i(4413),ne=i(1890),ie=i(1019),ae=i(8096),se=i(1383);let re=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[r.ez,ee.X,te.u,oe.e,ne.f,ie.i,ae.J,se.m,A.aw,K,I._8]}),o})()},1771:(G,g,i)=>{i.d(g,{U:()=>v});var r=i(9291),f=i(6223);const c=["*"];let v=(()=>{class p{constructor(){this.onSubmit=new r.vpe}ngOnChanges(u){}getFormData(){return"function"==typeof this.formData?this.formData(this.formGroup.value):{...this.formGroup.value}}reset(){this.formGroup.reset()}submit(){if(this.formGroup.markAllAsTouched(),this.formGroup.invalid)return;const u=this.getFormData();this.onSubmit.emit(u)}ngAfterContentInit(){}ngAfterContentChecked(){}ngOnDestroy(){}}return p.\u0275fac=function(u){return new(u||p)},p.\u0275cmp=r.Xpm({type:p,selectors:[["app-form"]],inputs:{formGroup:"formGroup",formData:"formData"},outputs:{onSubmit:"onSubmit"},features:[r.TTD],ngContentSelectors:c,decls:2,vars:1,consts:[[3,"formGroup","ngSubmit"]],template:function(u,Z){1&u&&(r.F$t(),r.TgZ(0,"form",0),r.NdJ("ngSubmit",function(){return Z.submit()}),r.Hsn(1),r.qZA()),2&u&&r.Q6J("formGroup",Z.formGroup)},dependencies:[f._Y,f.JL,f.sg]}),p})()}}]);