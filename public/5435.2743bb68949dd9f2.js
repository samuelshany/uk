"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[5435],{4896:(U,x,s)=>{s.d(x,{Y:()=>A});var a=s(9291),v=s(67),t=s(6223),u=s(6814),h=s(3999);function f(c,m){1&c&&a._UZ(0,"i",5)}function C(c,m){if(1&c&&(a.TgZ(0,"label"),a._uU(1),a.ALo(2,"titlecase"),a.ALo(3,"translate"),a.TgZ(4,"span",3),a.YNc(5,f,1,0,"i",4),a.qZA()()),2&c){const r=a.oxw();a.xp6(1),a.hij("",a.lcZ(2,2,a.lcZ(3,4,r.label))," "),a.xp6(4),a.Q6J("ngIf",r.control&&(null==r.control.errors?null:r.control.errors.required))}}let A=(()=>{class c extends v.t{constructor(r){super(),this.formGroupDirective=r,this.uploadedFiles=[],this.multiple=!0,this.label="Upload",this.accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx",this.onValueChange=new a.vpe}onFileSelected(r){this.onValueChange.emit(r)}onUpload(r){for(let d of r.files)this.uploadedFiles.push(d)}}return c.\u0275fac=function(r){return new(r||c)(a.Y36(t.sg,8))},c.\u0275cmp=a.Xpm({type:c,selectors:[["app-file-upload"]],inputs:{value:"value",multiple:"multiple",label:"label",accept:"accept"},outputs:{onValueChange:"onValueChange"},features:[a._Bn([{provide:t.JU,useExisting:c,multi:!0},{provide:t.Cf,useExisting:c,multi:!0}]),a.qOj],decls:3,vars:4,consts:[[1,"main"],[4,"ngIf"],["type","file","id","file",1,"form-control",3,"multiple","ngModel","accept","ngModelChange","change"],[1,"required-aster"],["class","fa-solid fa-asterisk",4,"ngIf"],[1,"fa-solid","fa-asterisk"]],template:function(r,d){1&r&&(a.TgZ(0,"div",0),a.YNc(1,C,6,6,"label",1),a.TgZ(2,"input",2),a.NdJ("ngModelChange",function(g){return d.value=g})("change",function(g){return d.onFileSelected(g)}),a.qZA()()),2&r&&(a.xp6(1),a.Q6J("ngIf",d.label),a.xp6(1),a.Q6J("multiple",d.multiple)("ngModel",d.value)("accept",d.accept))},dependencies:[u.O5,t.Fj,t.JJ,t.On,u.rS,h.X$],styles:[".main[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px dashed #7ca0c5;padding:7px;font-size:14px}"]}),c})()},5435:(U,x,s)=>{s.d(x,{f:()=>Q});var a=s(5861),v=s(8645),t=s(9291),u=s(8763),h=s(3999),f=s(2954),C=s(3562),A=s(1732),c=s(6814),m=s(6223),r=s(707),d=s(4896);function Z(i,_){if(1&i&&(t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA()()),2&i){const e=_.$implicit;t.xp6(2),t.Oqu(e.value)}}function g(i,_){if(1&i&&(t.TgZ(0,"div",16),t.YNc(1,Z,3,1,"div",11),t.ALo(2,"keyvalue"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.lcZ(2,1,e.errors))}}function O(i,_){if(1&i&&t._UZ(0,"img",25),2&i){const e=t.oxw(2).$implicit;t.Q6J("src",e.url,t.LSH)("alt",e.url)}}function b(i,_){if(1&i&&(t.TgZ(0,"p",26),t._uU(1),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.url)}}function M(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",27)(1,"app-file-upload",28),t.NdJ("onValueChange",function(o){t.CHM(e);const l=t.oxw(2),p=l.$implicit,T=l.index,P=t.oxw();return t.KtG(P.onFileSelected(o,p.id,T))}),t.qZA()()}2&i&&(t.xp6(1),t.Q6J("multiple",!1))}function w(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",29)(1,"button",30),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).index,l=t.oxw();return t.KtG(l.showInputFile(o))}),t._UZ(2,"img",31),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.deleteAttachment(o))}),t._UZ(6,"img",33),t.qZA()()}if(2&i){const e=t.oxw(2).$implicit;t.xp6(3),t.AsE(" ",t.lcZ(4,2,"change")," ",e.id,"")}}function E(i,_){if(1&i&&(t.TgZ(0,"div",18)(1,"div",19),t.YNc(2,O,1,2,"img",20),t.YNc(3,b,2,1,"p",21),t.qZA(),t.TgZ(4,"div",22),t.YNc(5,M,2,1,"div",23),t.YNc(6,w,7,4,"div",24),t.qZA()()),2&i){const e=t.oxw(),n=e.$implicit,o=e.index,l=t.oxw();t.xp6(2),t.Q6J("ngIf",!l.ids.includes(n.id)),t.xp6(1),t.Q6J("ngIf",l.ids.includes(n.id)),t.xp6(2),t.Q6J("ngIf",l.index==o),t.xp6(1),t.Q6J("ngIf",l.index!=o)}}function I(i,_){if(1&i&&(t.ynx(0),t.YNc(1,E,7,4,"div",17),t.BQk()),2&i){const e=_.$implicit;t.xp6(1),t.Q6J("ngIf",e.mime_type.includes("image"))}}function F(i,_){1&i&&(t.TgZ(0,"p",34),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"data_not_found")))}function J(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",27)(1,"app-file-upload",28),t.NdJ("onValueChange",function(o){t.CHM(e);const l=t.oxw(2),p=l.$implicit,T=l.index,P=t.oxw();return t.KtG(P.onFileSelected(o,p.id,T))}),t.qZA()()}2&i&&(t.xp6(1),t.Q6J("multiple",!1))}function L(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",29)(1,"button",30),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).index,l=t.oxw();return t.KtG(l.showInputFile(o))}),t._UZ(2,"img",31),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",32),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.deleteAttachment(o))}),t._UZ(6,"img",33),t.qZA()()}if(2&i){const e=t.oxw(2).$implicit;t.xp6(3),t.AsE(" ",t.lcZ(4,2,"change")," ",e.id,"")}}function y(i,_){if(1&i&&(t.TgZ(0,"div",18)(1,"div",35),t._UZ(2,"img",36),t.TgZ(3,"p",27),t._uU(4),t.qZA()(),t.TgZ(5,"div",22),t.YNc(6,J,2,1,"div",23),t.YNc(7,L,7,4,"div",24),t.qZA()()),2&i){const e=t.oxw(),n=e.$implicit,o=e.index,l=t.oxw();t.xp6(4),t.Oqu(n.url),t.xp6(2),t.Q6J("ngIf",l.index==o),t.xp6(1),t.Q6J("ngIf",l.index!=o)}}function D(i,_){if(1&i&&(t.ynx(0),t.YNc(1,y,8,3,"div",17),t.BQk()),2&i){const e=_.$implicit;t.xp6(1),t.Q6J("ngIf",!e.mime_type.includes("image"))}}function N(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",37)(1,"form",38)(2,"app-file-upload",28),t.NdJ("onValueChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.onFileSelectedNew(o))}),t.qZA()(),t.TgZ(3,"div",39)(4,"p-button",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onSubmitNew())}),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"p-button",41),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.showImportForm=!1)}),t.ALo(7,"translate"),t.qZA()()()}2&i&&(t.xp6(2),t.Q6J("multiple",!0),t.xp6(2),t.Q6J("label",t.lcZ(5,3,"save")),t.xp6(2),t.Q6J("label",t.lcZ(7,5,"cancel")))}function k(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",42)(1,"p-button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.showImportForm=!0)}),t.ALo(2,"translate"),t.qZA()()}2&i&&(t.xp6(1),t.Q6J("label",t.lcZ(2,1,"add")))}let Q=(()=>{class i{constructor(e,n,o,l,p){this.toastr=e,this.translateService=n,this.router=o,this.dynamicDialog=l,this.http=p,this.endPoint="",this.listPageRoute="",this.listPageTitle="",this.invoice_image=[],this.showImportForm=!1,this.filesIds=[],this.values=new FormData,this.fileName="",this.ids=[],this.unsubscribe=new v.x}ngOnInit(){this.activeId=this.data.id}onFileSelected(e,n,o){e.target.files[0]&&(this.ids.includes(n)||this.ids.push(n),this.values.set(`invoice_image[${n}]`,e.target.files[0]),this.ids.map((l,p)=>{this.values.set(`mediaId[${p}]`,l)})),this.data?.invoice_image.map((l,p)=>{this.index==p&&(l.url=e.target.files[0].name)})}onSubmit(){this.values.set("id",this.activeId),this.ids.length>0?this.http.post(this.endPoint,this.values).subscribe(e=>{this.toastr.success(e.message),this.clearAllForm(),this.router.navigate([this.listPageRoute])},e=>{this.errors=e.error.errors}):this.toastr.error(this.translateService.instant("no_file_changed"))}showInputFile(e){this.index=e}clearAllForm(){this.ids=[],this.filesIds=[],this.errors=null;for(const[e,n]of this.values)this.values.delete(e)}onFileSelectedNew(e){if(e.target.files[0])for(const[n,o]of Object.entries(e.target.files))this.values.set(`invoice_image[${n}]`,e.target.files[n]),this.filesIds.push(n)}onSubmitNew(){this.values.set("id",this.activeId),this.filesIds.length>0?this.http.post(this.endPoint,this.values).subscribe(e=>{this.toastr.success(e.message),this.clearAllForm(),this.router.navigate([this.listPageRoute])},e=>{this.errors=e.error.errors}):this.toastr.error(this.translateService.instant("no_file_changed"))}deleteAttachment(e){var n=this;return(0,a.Z)(function*(){n.values.set("id",n.activeId),n.values.set("mediaId[0]",e.id);const o={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",name:"url",data:{...e}},width:"300px",height:"164px"};(yield n.dynamicDialog.confirm(o))&&n.http.post(n.endPoint,n.values).subscribe(p=>{n.toastr.success(p.message),n.clearAllForm(),n.router.navigate([n.listPageRoute])},p=>{n.errors=p.error.errors})})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(u._W),t.Y36(h.sK),t.Y36(f.F0),t.Y36(C.U),t.Y36(A.O))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-update-attachment"]],inputs:{data:"data",endPoint:"endPoint",listPageRoute:"listPageRoute",listPageTitle:"listPageTitle"},decls:32,vars:27,consts:[[1,"page-card"],[1,"header","row","justify-content-between","align-items-center"],[1,"title","pointer","col-md-6",3,"routerLink"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","align-items-center","justify-content-end","g-2","col-md-6"],[1,"px-1"],["styleClass","btn-cancel",3,"routerLink","label"],["styleClass","btn-filter",3,"label","click"],["class","alert alert-danger text-center fs-5",4,"ngIf"],[1,"row","items"],[1,"fa-solid","fa-qrcode"],[4,"ngFor","ngForOf"],["class","text-center alert-danger alert ",4,"ngIf"],[1,"addNew"],["class","import",4,"ngIf"],["class","px-1","style","width: 100px; margin-top: 20px;",4,"ngIf"],[1,"alert","alert-danger","text-center","fs-5"],["class","col-md-3",4,"ngIf"],[1,"col-md-3"],[1,"img"],["class","w-100",3,"src","alt",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"d-flex","justify-content-center"],["class","",4,"ngIf"],["class","btns",4,"ngIf"],[1,"w-100",3,"src","alt"],[1,"text-center"],[1,""],["label","",3,"multiple","onValueChange"],[1,"btns"],[1,"btn-change",3,"click"],["src","assets/images/image.svg","alt",""],[1,"btn-delete",3,"click"],["src","assets/images/delete.svg","alt",""],[1,"text-center","alert-danger","alert"],[1,"file"],["src","assets/images/Frame.svg","alt","",1,""],[1,"import"],[1,"my-3"],[1,"d-flex","gap-2","align-items-center"],["styleClass","class",3,"label","click"],["styleClass","btn-cancel",3,"label","click"],[1,"px-1",2,"width","100px","margin-top","20px"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._UZ(3,"i",3),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",4)(7,"div",5),t._UZ(8,"p-button",6),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",5)(11,"p-button",7),t.NdJ("click",function(){return n.onSubmit()}),t.ALo(12,"translate"),t.qZA()()()(),t.YNc(13,g,3,3,"div",8),t.TgZ(14,"div",9)(15,"p"),t._UZ(16,"i",10),t._uU(17),t.ALo(18,"titlecase"),t.ALo(19,"translate"),t.qZA(),t.YNc(20,I,2,1,"ng-container",11),t.qZA(),t.TgZ(21,"div",9)(22,"p"),t._UZ(23,"i",10),t._uU(24),t.ALo(25,"titlecase"),t.ALo(26,"translate"),t.qZA(),t.YNc(27,F,3,3,"p",12),t.YNc(28,D,2,1,"ng-container",11),t.qZA(),t.TgZ(29,"div",13),t.YNc(30,N,8,7,"div",14),t.YNc(31,k,3,3,"div",15),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("routerLink",n.listPageRoute),t.xp6(2),t.hij("",t.lcZ(5,13,n.listPageTitle)," "),t.xp6(4),t.Q6J("routerLink",n.listPageRoute)("label",t.lcZ(9,15,"cancel")),t.xp6(3),t.Q6J("label",t.lcZ(12,17,"save")),t.xp6(2),t.Q6J("ngIf",n.errors),t.xp6(4),t.hij(" ",t.lcZ(18,19,t.lcZ(19,21,"images_list"))," "),t.xp6(3),t.Q6J("ngForOf",null==n.data?null:n.data.invoice_image),t.xp6(4),t.hij(" ",t.lcZ(25,23,t.lcZ(26,25,"files_list"))," "),t.xp6(3),t.Q6J("ngIf",0==(null==n.data||null==n.data.invoice_image?null:n.data.invoice_image.length)),t.xp6(1),t.Q6J("ngForOf",null==n.data?null:n.data.invoice_image),t.xp6(2),t.Q6J("ngIf",n.showImportForm),t.xp6(1),t.Q6J("ngIf",!n.showImportForm))},dependencies:[c.sg,c.O5,m._Y,m.JL,m.F,r.zx,f.rH,d.Y,c.rS,c.Nd,h.X$],styles:[".items[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:600;line-height:24px;color:#101828;margin:30px 0;width:100%}.items[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{height:200px;width:200px;border:1px solid var(--mainColor);border-radius:10px;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}.items[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.items[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:198px;border-radius:10px}.items[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{width:200px;height:200px;border:1px solid var(--mainColor);border-radius:14px;display:flex;flex-direction:column;justify-content:center;align-items:center;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}.items[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.items[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px 0;width:100%}.items[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{display:flex;gap:20px}.items[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   .btn-change[_ngcontent-%COMP%]{background:var(--white);color:var(--mainColor);border:1px solid var(--mainColor);border-radius:3px;margin:6px 0;padding:7px 0;font-size:14px;width:120px}.items[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{background:var(--white);color:var(--danger);border:1px solid var(--red);border-radius:3px;margin:6px 0;padding:7px 0;font-size:14px;width:60px}.customFileInput[_ngcontent-%COMP%]::-webkit-file-upload-button{visibility:hidden}.import[_ngcontent-%COMP%]{padding:20px;border:2px solid var(--mainColor);border-radius:8px;margin:10px 0}"]}),i})()}}]);