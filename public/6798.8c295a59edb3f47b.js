"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[6798],{6798:(H,g,i)=>{i.r(g),i.d(g,{ProductsModule:()=>B});var s=i(6814),h=i(2954),c=i(5861),a=function(o){return o.create="Create Product",o.view="View Product",o.edit="Edit Product",o.delete="Delete Product",o}(a||{}),x=i(3058);const u=o=>{return{cols:[{field:"code",label:"code",class:""},{field:"name",label:"name",class:""},{field:"quantity",label:"quantity",class:"",format:n=>n?.quantity?n?.quantity:"0"},{field:"selling_price",label:"selling_price",class:"",format:n=>n?.selling_price?n?.selling_price:"-"},{field:"category",label:"category",class:"",format:n=>n.category?n.category.name:"-"},{field:"material",label:"material",class:"",format:n=>n?.material?n?.material:"-"},{label:"action",actions:[{id:a.delete,icon:"fa-solid fa-person-harassing",class:"main-color",fun:(n=(0,c.Z)(function*(e){return yield o.productService.openDialogToAssignProduct(e)}),function(l){return n.apply(this,arguments)})},{id:a.delete,icon:"trash",class:"main-color",fun:function(){var n=(0,c.Z)(function*(e){return yield o.productService.delete(e)});return function(l){return n.apply(this,arguments)}}()},{id:a.edit,icon:"pen-to-square",class:"main-color",fun:function(){var n=(0,c.Z)(function*(e){return yield o.productService.openDialogToUpdateProduct(e)});return function(l){return n.apply(this,arguments)}}()}]}],Request:x.s.api.get};var n};var p=i(5946),d=i(6924),b=i(8718),T=i(5219),t=i(9291),Z=i(4472),L=i(8763),f=i(3999),A=i(2377),M=i(359),S=i(4896),P=i(4779),J=i(5077),F=i(4811),E=i(8275);function N(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",17)(1,"button",18),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ul",19)(5,"li",20),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.exportExample())}),t._uU(6),t.ALo(7,"titlecase"),t.ALo(8,"translate"),t.qZA()()()}2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"export")," "),t.xp6(4),t.hij(" ",t.lcZ(7,4,t.lcZ(8,6,"example"))," "))}function _(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"app-button",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.openDialogToCreate())}),t.qZA()}if(2&o){const e=t.oxw();t.Tol("btn-filter "),t.Q6J("text","new")("icon",e.icon.PLUS)("iconPos","left")}}function O(o,n){if(1&o&&(t.TgZ(0,"div")(1,"span",29),t._uU(2),t.qZA(),t.TgZ(3,"span",29),t._uU(4),t.qZA()()),2&o){const e=n.$implicit;t.xp6(2),t.hij(" row :",e.row_number," "),t.xp6(2),t.Oqu(e.error)}}function Q(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",22),t.YNc(1,O,5,2,"div",23),t.TgZ(2,"app-file-upload",24),t.NdJ("onValueChange",function(r){t.CHM(e);const m=t.oxw();return t.KtG(m.onFileSelected(r))}),t.qZA(),t.TgZ(3,"div",25)(4,"app-button",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.import())}),t._UZ(5,"i",27),t.qZA(),t.TgZ(6,"app-button",28),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.closeSectionToImport())}),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.importErrors),t.xp6(1),t.Q6J("multiple",!1)("accept",".csv,.xls,.xlsx")("label","import"),t.xp6(2),t.Q6J("text","save")("loading",e.isLoading),t.xp6(2),t.Q6J("text","cancel")}}const v=function(o){return[o]},I=[{path:"",component:(()=>{class o{constructor(e,l,r){this.productService=e,this.toastr=l,this.translateService=r,this.showImportForm=!1,this.importErrors=[],this.fileName="",this.values=new FormData,this.isLoading=!1,this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"name",field:"name"},{label:"purchase_price",field:"purchase_price"},{label:"selling_price",field:"selling_price"},{label:"creator",field:"creator_id"},{label:"quantity",field:"quantity"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:p.q.asc,field:p.q.asc},{label:p.q.desc,field:p.q.desc}]}],this.filtersConfig=[{field:"search",label:"search",type:d.W.TEXT,placeholder:"search"},{field:"creator_id",label:"created_by",type:d.W.SELECT,options:{value:"id",label:"name"},request:b.x.api.get,placeholder:"select"},{field:"from",label:"from",type:d.W.DATE},{field:"to",label:"to",type:d.W.DATE}],this.permissions=a,this.tableConfig=u(this),this.icon=T.dv}openDialogToCreate(){var e=this;return(0,c.Z)(function*(){(yield e.productService.openDialogToCreateUnitType())&&(e.tableConfig=u(e))})()}openSectionToImport(){this.showImportForm=!0}closeSectionToImport(){this.fileName="",this.showImportForm=!1,this.importErrors=[]}exportExample(){this.productService.exportExample().subscribe(e=>{window.open(e.file_path)})}onFileSelected(e){e.target.files[0]&&(this.fileName=e.target.files[0].name,this.values.set("file",e.target.files[0]))}import(){this.fileName?(this.isLoading=!0,this.productService.import(this.values).subscribe(e=>{this.toastr.success(e.message),this.isLoading=!1,this.fileName="",this.closeSectionToImport(),this.tableConfig=u(this)},e=>{this.isLoading=!1,this.importErrors=e.error.errors,e.error.message&&this.toastr.error(e.error.message)})):this.toastr.error(this.translateService.instant("select_file"))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(Z.M),t.Y36(L._W),t.Y36(f.sK))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-list"]],decls:20,vars:19,consts:[[1,"page-card"],[1,"d-flex","align-items-center","justify-content-between"],[1,"title"],[1,"d-flex","gap-2"],["class","dropdown",4,"hasPermissions"],[3,"text","click"],[3,"text","class","icon","iconPos","click",4,"hasPermissions"],["class","import",4,"ngIf"],[1,"d-flex","flex-row","align-items-center","justify-content-between"],[3,"SortConfig"],["sort",""],[3,"config"],["filter",""],[1,"table","mt-2"],[3,"tableConfig","pagination","filter","sort"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""],[1,"dropdown"],["type","button","id","dropdownMenuButton1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-cancel","dropdown-toggle"],["aria-labelledby","dropdownMenuButton1",1,"dropdown-menu"],[1,"pointer","dropdown-item",3,"click"],[3,"text","icon","iconPos","click"],[1,"import"],[4,"ngFor","ngForOf"],[3,"multiple","accept","label","onValueChange"],[1,"d-flex","gap-2","align-items-center","mt-3"],[3,"text","loading","click"],[1,"fa-solid","fa-check","px-2"],[1,"btn-cancel",3,"text","click"],[1,"text-error"]],template:function(e,l){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3),t.YNc(6,N,9,8,"div",4),t.TgZ(7,"app-button",5),t.NdJ("click",function(){return l.openSectionToImport()}),t.qZA(),t.YNc(8,_,1,5,"app-button",6),t.qZA()(),t.YNc(9,Q,7,7,"div",7),t.TgZ(10,"div",8),t._UZ(11,"ukt-sort",9,10)(13,"ukt-filter",11,12),t.qZA(),t.TgZ(15,"div",13),t._UZ(16,"app-table",14),t.qZA(),t.TgZ(17,"div",15),t._UZ(18,"ukt-pagination",null,16),t.qZA()()),2&e){const r=t.MAs(12),m=t.MAs(14),G=t.MAs(19);t.xp6(3),t.Oqu(t.lcZ(4,13,"list_of_products")),t.xp6(3),t.Q6J("hasPermissions",t.VKq(15,v,l.permissions.create)),t.xp6(1),t.Tol("btn-cancel"),t.Q6J("text","import"),t.xp6(1),t.Q6J("hasPermissions",t.VKq(17,v,l.permissions.create)),t.xp6(1),t.Q6J("ngIf",l.showImportForm),t.xp6(2),t.Q6J("SortConfig",l.sortConfig),t.xp6(2),t.Q6J("config",l.filtersConfig),t.xp6(3),t.Q6J("tableConfig",l.tableConfig)("pagination",G)("filter",m)("sort",r)}},dependencies:[s.sg,s.O5,A.a,M.Q,S.Y,P.r,J.z,F.x,E.z,s.rS,f.X$],styles:[".dropdown[_ngcontent-%COMP%]{background-color:transparent!important}.dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent!important;border:1px solid var(--mainColor);font-size:1.5rem;padding:6px}.dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:1.5rem}.import[_ngcontent-%COMP%]{padding:20px;border:2px solid var(--mainColor);border-radius:8px;margin:10px 0}"]}),o})()}];let U=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(I),h.Bz]}),o})();var D=i(8096),j=i(1019),w=i(1890),K=i(4413),V=i(2115),Y=i(1471),z=i(1383);let B=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[s.ez,U,Y.X,V.u,K.e,w.f,j.i,D.J,f.aw,z.m]}),o})()}}]);