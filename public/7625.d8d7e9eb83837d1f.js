"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[7625],{7553:(v,m,n)=>{n.d(m,{F:()=>u});const u={api:{create:"tax/create",get:"tax",getModules:"module",getById:"tax/",update:"tax/update/",delete:"tax/",exportCvs:"tax/export/cvs",exportPdf:"tax/export/pdf",import:"tax/import"},page:{list:"",view:"view/:id",history:"history"}}},9768:(v,m,n)=>{n.d(m,{f:()=>u});var u=function(s){return s.list="View Taxes",s.create="Create Tax",s.update="Edit Tax",s.delete="Delete Tax",s}(u||{})},7625:(v,m,n)=>{n.d(m,{N:()=>y});var u=n(5861),s=n(7553),o=n(5619),P=n(6306),C=n(8504),d=n(6223),T=n(9768),t=n(9291),_=n(8763),x=n(5118),O=n(6814),l=n(1771),h=n(8614),a=n(5304),r=n(4779),b=n(3999);function M(c,f){if(1&c&&(t.TgZ(0,"p",19),t._uU(1),t.qZA()),2&c){const e=f.$implicit;t.xp6(1),t.hij(" ",e.value," ")}}let Z=(()=>{class c{constructor(e,i,p,A,g){this.texesService=e,this.fb=i,this.toastr=p,this.config=A,this.dialogRef=g,this.formGroup=this.initForm(),this.permissions=T.f,this.selectedModules=[],this.isSubmitted=!1,this.isLoading=!1,this.action="",this.config.data?.data&&this.fillDataToUpdate(this.config.data?.data)}ngOnInit(){this.texesService.getAction().subscribe(e=>{this.action=e}),this.texesService.getModules().subscribe(e=>{this.modules=e},e=>{})}initForm(){return this.fb.group({id:[Number],name:["",[d.kI.required]],modules:["",d.kI.required],percentage:this.fb.control("",[d.kI.required,d.kI.pattern("^[0-9.]+$")])})}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():this.config.data.data?this.texesService.update(this.formGroup.value).subscribe({next:e=>{this.toastr.success(e.message),this.closePopup(!0)},error:e=>{this.toastr.error(e.error.message),this.errors=e.error.errors}}):this.texesService.create(this.formGroup.value).subscribe({next:e=>{this.toastr.success(e.message),this.closePopup(!0)},error:e=>{this.errors=e.error.errors,this.toastr.error(e.error.message)}})}closePopup(e){this.dialogRef.close(e)}fillDataToUpdate(e){this.formGroup.patchValue({id:e.id,name:e.name,percentage:e.percentage,modules:e.modules.map(i=>i.id)})}}return c.\u0275fac=function(e){return new(e||c)(t.Y36(y),t.Y36(d.qu),t.Y36(_._W),t.Y36(x.S),t.Y36(x.E7))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-add-texes"]],decls:25,vars:28,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","../assets/texes/texes.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[3,"formGroup"],["class","text-error",4,"ngFor","ngForOf"],[1,"row"],[1,"mb-5","col-12"],["formControlName","name",3,"text","placeholder"],[1,"col-12","mb-5"],["ngDefaultControl","","formControlName","modules",3,"text","data","optionLabel","optionValue","placeholder"],["formControlName","percentage",3,"text","placeholder"],[1,"row","g-2","my-2"],[1,"col-6"],[3,"text","click"],[1,"text-error"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),t._UZ(4,"img",4),t.qZA(),t.TgZ(5,"span",5),t.NdJ("click",function(){return i.closePopup(!1)}),t._UZ(6,"i",6),t.qZA()(),t.TgZ(7,"p",7),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"app-form",8),t.YNc(11,M,2,1,"p",9),t.ALo(12,"keyvalue"),t.TgZ(13,"div",10)(14,"div",11),t._UZ(15,"app-text",12),t.qZA(),t.TgZ(16,"div",13),t._UZ(17,"app-multiselect",14),t.qZA(),t.TgZ(18,"div",11),t._UZ(19,"app-text",15),t.qZA()(),t.TgZ(20,"div",16)(21,"div",17)(22,"app-button",18),t.NdJ("click",function(){return i.closePopup(!1)}),t.qZA()(),t.TgZ(23,"div",17)(24,"app-button",18),t.NdJ("click",function(){return i.accept()}),t.qZA()()()()()),2&e){let p;t.xp6(8),t.Oqu(t.lcZ(9,24,null!==(p=i.config.header)&&void 0!==p?p:"")),t.xp6(2),t.Q6J("formGroup",i.formGroup),t.xp6(1),t.Q6J("ngForOf",t.lcZ(12,26,i.errors)),t.xp6(4),t.Tol(""),t.Q6J("text","name")("placeholder",""),t.xp6(2),t.Tol(""),t.Q6J("text","modules")("data",i.modules)("optionLabel","name")("optionValue","id")("placeholder","select"),t.xp6(2),t.Tol(""),t.Q6J("text","percentage")("placeholder",""),t.xp6(3),t.Tol("btn-cancel"),t.Q6J("text","Cancel"),t.xp6(2),t.Tol("btn-filter"),t.Q6J("text",null==i.config.data?null:i.config.data.acceptLabel)}},dependencies:[O.sg,l.U,d.Fj,d.JJ,d.JL,d.sg,d.u,h.T,a.z,r.r,O.Nd,b.X$],styles:["[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:600;font-size:1.8rem;line-height:24px;color:var(--mainColor)}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   .title-model[_ngcontent-%COMP%]{padding:1rem!important;font-style:normal;font-weight:600;font-size:1.8rem;line-height:28px;color:var(--mainColor)}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:500;color:#344054}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:1.6rem!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-size:1.6rem!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1.6rem!important;background-color:transparent!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:1.6rem!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:1.5rem!important;padding:7px!important;border:none!important;outline:none!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .module[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .auth-name[_ngcontent-%COMP%]{background-color:#c6dfe2!important;border-radius:24px!important;padding:6px 15px;margin:.5rem 1rem!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     app-select-option select{background-color:var(--white)!important;border:1px solid #ced4da!important}[_nghost-%COMP%]   .main[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     app-input input{background-color:var(--white)!important;border:1px solid #ced4da!important}"]}),c})();var L=n(1732),D=n(3562);let y=(()=>{class c{constructor(e,i,p){this.http=e,this.dynamicDialog=i,this.toastr=p,this.texes=new o.X({}),this.modules=new o.X([]),this.action=new o.X("create")}get(e){return this.http.get(s.F.api.get)}getModules(){return this.http.get(s.F.api.getModules)}addTex(e){return this.http.post("tax/create",e).pipe((0,P.K)(i=>(0,C._)(()=>i||"some error from server ")))}updateTex(e){return this.http.post(s.F.api.update+e.id,e)}getAction(){return this.action}setAction(e){this.action.next(e)}getTaxes(){return this.texes}setTexes(e){this.texes.next(e)}setModules(e){this.modules.next(e)}getAllTexes(){return this.http.get("tax?limit=99999")}openDialogToCreate(){return this.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"add_tax",data:{acceptLabel:"add",rejectLabel:"cancel"},width:"500px",height:"auto"},Z)}create(e){return this.http.post(s.F.api.create,e)}delete(e){var i=this;return(0,u.Z)(function*(){const p={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...e}},width:"300px",height:"164px"};return!!(yield i.dynamicDialog.confirm(p))&&i.http.delete(s.F.api.delete+e.id).toPromise().then(g=>(i.toastr.success(g.message),g)).catch(g=>(i.toastr.error(g.error.message),g))})()}openDialogToUpdate(e){var i=this;return(0,u.Z)(function*(){const p={showHeader:!1,header:"update_tax",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...e}},width:"480px",height:"auto"};return yield i.dynamicDialog.showDialogWithComponent(p,Z)})()}update(e){return this.http.post(s.F.api.update+e.id,e)}}return c.\u0275fac=function(e){return new(e||c)(t.LFG(L.O),t.LFG(D.U),t.LFG(_._W))},c.\u0275prov=t.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5304:(v,m,n)=>{n.d(m,{z:()=>O});var u=n(67),s=n(6223),o=n(9291),P=n(1732),C=n(6814),d=n(4055),T=n(3999);function t(l,h){1&l&&o._UZ(0,"i",6)}function _(l,h){if(1&l&&(o.TgZ(0,"label"),o._uU(1),o.ALo(2,"titlecase"),o.ALo(3,"translate"),o.TgZ(4,"span",4),o.YNc(5,t,1,0,"i",5),o.qZA()()),2&l){const a=o.oxw();o.xp6(1),o.hij("",o.lcZ(2,2,o.lcZ(3,4,a.text))," "),o.xp6(4),o.Q6J("ngIf",a.control&&(null==a.control.errors?null:a.control.errors.required))}}function x(l,h){if(1&l&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&l){const a=o.oxw();o.Tol("text-danger"),o.xp6(1),o.Oqu(o.lcZ(2,3,a.object.keys(a.control.errors)[0]))}}let O=(()=>{class l extends u.t{constructor(a,r){super(),this.formGroupDirective=a,this.http=r,this.valueToUpdate=[],this.readOnly=!1,this.placeholder="",this.filterBy="",this.class="d-flex justify-content-between align-items-center",this.filter=!0,this.filterMatchMode="contains",this.object=Object,this.scrollHeight="100px"}ngOnInit(){!this.data&&this.request?this.http.getWithParam(this.request,{limit:"all"}).subscribe({next:a=>{this.data=a.data,this.writeValue(this.valueToUpdate),this.data?.length>4&&(this.scrollHeight="200px")},error:a=>{}}):this.writeValue(this.valueToUpdate)}writeValue(a){this.data&&(this.value=a)}onValueChange(a){this.onChange(a.value),this.onTouched()}ngOnChanges(a){a.data&&this.data?.length>4&&(this.scrollHeight="200px")}}return l.\u0275fac=function(a){return new(a||l)(o.Y36(s.sg,8),o.Y36(P.O))},l.\u0275cmp=o.Xpm({type:l,selectors:[["app-multiselect"]],inputs:{value:"value",text:"text",data:"data",optionLabel:"optionLabel",optionValue:"optionValue",editable:"editable",readOnly:"readOnly",placeholder:"placeholder",filterBy:"filterBy",request:"request",class:"class",filter:"filter",filterMatchMode:"filterMatchMode"},features:[o._Bn([{provide:s.JU,useExisting:l,multi:!0},{provide:s.Cf,useExisting:l,multi:!0}]),o.qOj,o.TTD],decls:5,vars:18,consts:[[3,"ngClass"],[4,"ngIf"],["appendTo","body",3,"options","ngModel","placeholder","optionLabel","optionValue","filterMatchMode","display","filter","filterBy","disabled","virtualScroll","scrollHeight","virtualScrollItemSize","ngModelChange","onChange"],[3,"class",4,"ngIf"],[1,"required-aster"],["class","fa-solid fa-asterisk",4,"ngIf"],[1,"fa-solid","fa-asterisk"]],template:function(a,r){1&a&&(o.TgZ(0,"div",0),o.YNc(1,_,6,6,"label",1),o.TgZ(2,"p-multiSelect",2),o.NdJ("ngModelChange",function(M){return r.value=M})("onChange",function(M){return r.onValueChange(M)}),o.ALo(3,"translate"),o.qZA(),o.YNc(4,x,3,5,"span",3),o.qZA()),2&a&&(o.Q6J("ngClass",r.class),o.xp6(1),o.Q6J("ngIf",r.text),o.xp6(1),o.Q6J("options",r.data)("ngModel",r.value)("placeholder",o.lcZ(3,16,r.placeholder))("optionLabel",r.optionLabel)("optionValue",r.optionValue)("filterMatchMode",r.filterMatchMode)("display","chip")("filter",r.filter)("filterBy",r.optionLabel)("disabled",r.readOnly)("virtualScroll",!0)("scrollHeight",r.scrollHeight)("virtualScrollItemSize",30),o.xp6(2),o.Q6J("ngIf",r.control&&r.control.errors&&(r.control.touched||r.formGroupDirective.submitted)))},dependencies:[C.mk,C.O5,s.JJ,s.On,d.NU,C.rS,T.X$],styles:[".text-danger[_ngcontent-%COMP%]{font-size:14px}"]}),l})()}}]);