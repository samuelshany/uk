"use strict";(self.webpackChunkkey=self.webpackChunkkey||[]).push([[6460],{6460:(L,T,n)=>{n.r(T),n.d(T,{FixedAssetModule:()=>ne});var r=n(6814),Z=n(2954),c=n(5861),f=function(i){return i.list="View Fixed Assets",i.create="Create Fixed Asset",i.update="Edit Fixed Asset",i.delete="Delete Fixed Asset",i}(f||{});const p={api:{create:"fixed-asset/create",get:"fixed-asset",getParents:"parents/accounts",getNotParents:"not-parents/accounts",getById:"fixed-asset/",update:"fixed-asset/update/",delete:"fixed-asset/",export:"fixed-asset/export",exportExample:"fixed-asset/export/example",import:"fixed-asset/import"},page:{list:"",update:"update/:id",view:"view/:id",create:"new"}},_=i=>{return{cols:[{field:"code",label:"code",class:""},{field:"name",label:"name",class:""},{field:"description",label:"description",format:a=>a.description?a.description:"-"},{field:"depreciation_duration_type",label:"duration_type",class:"",format:a=>a.depreciation_duration_type?a.depreciation_duration_type:"-"},{field:"depreciation_duration_value",label:"duration_value",class:"",format:a=>a.depreciation_duration_value?a.depreciation_duration_value:"-"},{field:"acquisition_date",label:"acquisition_date",class:"",format:a=>a.acquisition_date?a.acquisition_date:"-"},{field:"created_at",label:"created_at",class:"",format:a=>a.created_at?a.created_at:"-"},{field:"creator",label:"created_by",class:"",format:a=>a.creator?a.creator:"-"},{field:"depreciation_ratio",label:"ratio",format:a=>a.depreciation_ratio?a.depreciation_ratio:"-"},{label:"action",actions:[{id:f.delete,icon:"trash",class:"main-color",fun:(a=(0,c.Z)(function*(t){return yield i.fixedAssetService.delete(t)}),function(o){return a.apply(this,arguments)})},{id:f.update,icon:"pen-to-square",class:"main-color",fun:function(){var a=(0,c.Z)(function*(t){return yield i.fixedAssetService.openDialogToUpdate(t)});return function(o){return a.apply(this,arguments)}}()}]}],Request:p.api.get};var a};var u=n(6924),d=n(5946),e=n(9291),s=n(6223),v=n(8763),h=n(5118),U=n(2525),J=n(8614),M=n(1904),D=n(3838),E=n(6098),O=n(1771),F=n(4779),C=n(3999);function q(i,a){if(1&i&&(e.TgZ(0,"div")(1,"p",27),e._uU(2),e.qZA()()),2&i){const t=a.$implicit;e.xp6(2),e.hij(" ",t.value,"")}}let A=(()=>{class i{constructor(t,o,l,x,m,ae){this.fb=t,this.toastr=o,this.config=l,this.dialogRef=x,this.fixedAssetService=m,this.groupService=ae,this.formGroup=this.initForm(),this.fixedAssetConfig=p,this.permissions=f,this.depreciation_duration_types=[{id:"year",name:"year"},{id:"month",name:"month"}],this.config.data?.data&&this.fillDataToUpdate(this.config.data?.data)}ngOnInit(){this.fixedAssetService.getNotParents().subscribe(t=>{this.account_types=t.data})}initForm(){return this.fb.group({id:[Number],name:["",[s.kI.required]],description:[""],acquisition_date:["",s.kI.required],acquisition_value:["",s.kI.required],depreciation_ratio:[""],depreciation_value:["",s.kI.required],depreciation_duration_value:[""],depreciation_duration_type:["",s.kI.required],parent_id:["",s.kI.required]})}setAccountId(t){let o=this.account_types.filter(l=>l.id==t.value)[0];this.formGroup.get("parent_coded")?.patchValue(o.code)}fillDataToUpdate(t){this.formGroup.patchValue({id:t.id,name:t?.name,description:t?.description,acquisition_date:t?.acquisition_date,acquisition_value:t.acquisition_value,depreciation_ratio:t?.depreciation_ratio,depreciation_value:t.depreciation_value,depreciation_duration_value:t.depreciation_duration_value,depreciation_duration_type:t.depreciation_duration_type,parent_id:t?.parent.id,parent_code:t.parent.code})}accept(){this.formGroup.invalid?this.formGroup.markAllAsTouched():this.config.data.data?this.fixedAssetService.update(this.formGroup.value).subscribe({next:t=>{this.toastr.success(t.message),this.closePopup(!0)},error:t=>{this.errors=t.error.errors,this.toastr.error(t.error.message)}}):this.fixedAssetService.create(this.formGroup.value).subscribe({next:t=>{this.toastr.success(t.message),this.closePopup(!0)},error:t=>{this.errors=t.error.errors,this.toastr.error(t.error.message)}})}closePopup(t){this.dialogRef.close(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(s.qu),e.Y36(v._W),e.Y36(h.S),e.Y36(h.E7),e.Y36(y),e.Y36(U.l))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-fixed-form"]],decls:38,vars:48,consts:[[1,"main"],[1,"header"],[1,"d-flex","justify-content-between"],[1,"icon"],["src","../assets/Tabs/Icon/Active/craete-bank.png","alt","img"],[3,"click"],[1,"fa-solid","fa-xmark","pointer","fs-1"],[1,"title"],[3,"formGroup"],[4,"ngFor","ngForOf"],[1,"row"],[1,"mb-5","col-sm-12"],["formControlName","name","ngDefaultControl","","placeholder","",3,"text"],["formControlName","description","ngDefaultControl","","placeholder","",3,"text"],[1,"mb-5","col-12"],["formControlName","acquisition_date","ngDefaultControl","","placeholder","",3,"text"],["formControlName","acquisition_value","ngDefaultControl","",3,"mode","showButtons","text"],["formControlName","depreciation_ratio","ngDefaultControl","",3,"text"],["formControlName","depreciation_value","ngDefaultControl","",3,"showButtons","mode","text"],[1,"mb-5","col-12","col-md-6"],["formControlName","depreciation_duration_value","ngDefaultControl","",3,"text"],["placeholder","select","optionLabel","name","optionValue","id","formControlName","depreciation_duration_type","ngDefaultControl","",3,"text","data"],[1,"mb-3","col-12"],["placeholder","select","optionLabel","name_code","optionValue","id","formControlName","parent_id",3,"text","filter","filterBy","request"],[1,"row","g-2","my-2"],[1,"col-6"],[3,"text","click"],[1,"text-error"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._UZ(4,"img",4),e.qZA(),e.TgZ(5,"span",5),e.NdJ("click",function(){return o.closePopup(!1)}),e._UZ(6,"i",6),e.qZA()(),e.TgZ(7,"p",7),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"app-form",8),e.YNc(11,q,3,1,"div",9),e.ALo(12,"keyvalue"),e.TgZ(13,"div",10)(14,"div",11),e._UZ(15,"app-text",12),e.qZA(),e.TgZ(16,"div",11),e._UZ(17,"app-text",13),e.qZA(),e.TgZ(18,"div",14),e._UZ(19,"app-date",15),e.qZA(),e.TgZ(20,"div",14),e._UZ(21,"app-number-input",16),e.qZA(),e.TgZ(22,"div",14),e._UZ(23,"app-number-input",17),e.qZA(),e.TgZ(24,"div",14),e._UZ(25,"app-number-input",18),e.qZA(),e.TgZ(26,"div",10)(27,"div",19),e._UZ(28,"app-number-input",20),e.qZA(),e.TgZ(29,"div",19),e._UZ(30,"app-dropdown",21),e.qZA()(),e.TgZ(31,"div",22),e._UZ(32,"app-dropdown",23),e.qZA()(),e.TgZ(33,"div",24)(34,"div",25)(35,"app-button",26),e.NdJ("click",function(){return o.closePopup(!1)}),e.qZA()(),e.TgZ(36,"div",25)(37,"app-button",26),e.NdJ("click",function(){return o.accept()}),e.qZA()()()()()),2&t){let l;e.xp6(8),e.Oqu(e.lcZ(9,44,null!==(l=o.config.header)&&void 0!==l?l:"")),e.xp6(2),e.Q6J("formGroup",o.formGroup),e.xp6(1),e.Q6J("ngForOf",e.lcZ(12,46,o.errors)),e.xp6(4),e.Tol(""),e.Q6J("text","name"),e.xp6(2),e.Tol(""),e.Q6J("text","description"),e.xp6(2),e.Tol(""),e.Q6J("text","acquisition_date"),e.xp6(2),e.Tol(""),e.Q6J("mode","currency")("showButtons",!1)("text","acquisition_value"),e.xp6(2),e.Tol(""),e.Q6J("text","ratio"),e.xp6(2),e.Tol(""),e.Q6J("showButtons",!1)("mode","currency")("text","depreciation_value"),e.xp6(3),e.Tol(""),e.Q6J("text","depreciation_duration_value"),e.xp6(2),e.Tol(""),e.Q6J("text","deprecation_type")("data",o.depreciation_duration_types),e.xp6(2),e.Tol(""),e.Q6J("text","account_parent")("filter",!0)("filterBy","name_code")("request",o.fixedAssetConfig.api.getParents),e.xp6(3),e.Tol("btn-cancel"),e.Q6J("text","Cancel"),e.xp6(2),e.Tol("btn-filter"),e.Q6J("text",null==o.config.data?null:o.config.data.acceptLabel)}},dependencies:[r.sg,J.T,M.D,D.J,E.I,O.U,s.Fj,s.JJ,s.JL,s.sg,s.u,F.r,r.Nd,C.X$]}),i})();var N=n(1732),I=n(3562);let y=(()=>{class i{constructor(t,o,l){this.http=t,this.dynamicDialog=o,this.toastr=l}get(t){return this.http.get(p.api.get)}getParents(t){return this.http.get(p.api.getParents)}getNotParents(t){return this.http.get(p.api.getNotParents)}getById(t){return this.http.get(p.api.getById+t)}openDialogToCreate(){var t=this;return(0,c.Z)(function*(){return yield t.dynamicDialog.showDialogWithComponent({showHeader:!1,header:"add_fixed_asset",data:{acceptLabel:"Add",rejectLabel:"Cancel"},width:"480px",height:"h-100"},A)})()}create(t){return this.http.post(p.api.create,t)}delete(t){var o=this;return(0,c.Z)(function*(){const l={showHeader:!1,header:"delete",data:{message:"do_you_want_to_delete",acceptLabel:"delete",rejectLabel:"close",data:{...t}},width:"480px",height:"auto"};if(!(yield o.dynamicDialog.confirm(l)))return!1;try{const m=yield o.http.delete(p.api.delete+t.id).toPromise();return o.toastr.success(m.message),m}catch(m){return o.toastr.error(m.error.message),m}})()}openDialogToUpdate(t){var o=this;return(0,c.Z)(function*(){const l={showHeader:!1,header:"update_fixed_asset",data:{acceptLabel:"update",rejectLabel:"Cancel",data:{...t}},height:"auto",width:"500px",styleClass:"financial-dialog"};return yield o.dynamicDialog.showDialogWithComponent(l,A)})()}update(t){return this.http.post(p.api.update+t.id,t)}import(t){return this.http.post(p.api.import,t)}export(){return this.http.get(p.api.export)}exportExample(){return this.http.get(p.api.exportExample)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(N.O),e.LFG(I.U),e.LFG(v._W))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var S=n(8275),P=n(2377),Q=n(4896),B=n(359),G=n(5077),w=n(3826);function Y(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"button",19),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"ul",20)(5,"li",21),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.exportExample())}),e._uU(6),e.ALo(7,"titlecase"),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"li",21),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.export())}),e._uU(10),e.ALo(11,"titlecase"),e.ALo(12,"translate"),e.qZA()()()}2&i&&(e.xp6(2),e.hij(" ",e.lcZ(3,3,"export")," "),e.xp6(4),e.Oqu(e.lcZ(7,5,e.lcZ(8,7,"example"))),e.xp6(4),e.Oqu(e.lcZ(11,9,e.lcZ(12,11,"data"))))}function j(i,a){if(1&i&&(e.TgZ(0,"div")(1,"span",29),e._uU(2),e.qZA(),e.TgZ(3,"span",29),e._uU(4),e.qZA()()),2&i){const t=a.$implicit;e.xp6(2),e.hij(" row :",t.row_number," "),e.xp6(2),e.Oqu(t.error)}}function W(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",22),e.YNc(1,j,5,2,"div",23),e.TgZ(2,"app-file-upload",24),e.NdJ("onValueChange",function(l){e.CHM(t);const x=e.oxw();return e.KtG(x.onFileSelected(l))}),e.qZA(),e.TgZ(3,"div",25)(4,"app-button",26),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.import())}),e._UZ(5,"i",27),e.qZA(),e.TgZ(6,"app-button",28),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.closeSectionToImport())}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.importErrors),e.xp6(1),e.Q6J("multiple",!1)("accept",".csv,.xls,.xlsx")("label","import"),e.xp6(2),e.Q6J("text","save")("loading",t.isLoading),e.xp6(2),e.Q6J("text","cancel")}}const V=function(i){return[i]},k=[{path:"",component:(()=>{class i{constructor(t,o,l){this.fixedAssetService=t,this.toastr=o,this.translateService=l,this.showImportForm=!1,this.importErrors=[],this.fileName="",this.values=new FormData,this.isLoading=!1,this.tableConfig=_(this),this.permissions=f,this.financialFilterConfig=[{field:"search",label:"search",type:u.W.TEXT,placeholder:"search_by_name_or_description"},{field:"acquisition_value",label:"acquisition_value",type:u.W.TEXT,placeholder:""},{field:"depreciation_ratio",label:"depreciation_ratio",type:u.W.TEXT,placeholder:""},{field:"depreciation_value",label:"depreciation_value",type:u.W.TEXT,placeholder:""},{field:"acquisition_date",label:"acquisition_date",type:u.W.DATE},{field:"from",label:"from",type:u.W.DATE,placeholder:"From"},{field:"to",label:"to",type:u.W.DATE}],this.sortConfig=[{optionLabel:"label",optionValue:"field",key:"sort_by",placeholder:"sort_by",data:[{label:"name",field:"name"},{label:"created_at",field:"created_at"},{label:"creator",field:"creator_id"},{label:"code",field:"code"},{label:"acquisition_value",field:"acquisition_value"},{label:"acquisition_date",field:"acquisition_date"},{label:"depreciation_ratio",field:"depreciation_ratio"},{label:"parent",field:"parent_id"},{label:"depreciation_value",field:"depreciation_value"}]},{optionLabel:"label",optionValue:"field",key:"sort_type",placeholder:"sort_type",data:[{label:d.q.asc,field:d.q.asc},{label:d.q.desc,field:d.q.desc}]}]}openDialogToCreate(){var t=this;return(0,c.Z)(function*(){(yield t.fixedAssetService.openDialogToCreate())&&(t.tableConfig=_(t))})()}openSectionToImport(){this.showImportForm=!0}closeSectionToImport(){this.fileName="",this.showImportForm=!1,this.importErrors=[]}export(t){this.fixedAssetService.export().subscribe(o=>{window.open(o.file_path)})}exportExample(){this.fixedAssetService.exportExample().subscribe(t=>{window.open(t.file_path)})}onFileSelected(t){t.target.files[0]&&(this.fileName=t.target.files[0].name,this.values.set("file",t.target.files[0]))}import(){this.fileName?(this.isLoading=!0,this.fixedAssetService.import(this.values).subscribe(t=>{this.toastr.success(t.message),this.isLoading=!1,this.fileName="",this.closeSectionToImport(),this.tableConfig=_(this)},t=>{this.isLoading=!1,this.importErrors=t.error.errors,t.error.message&&this.toastr.error(t.error.message)})):this.toastr.error(this.translateService.instant("select_file"))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(y),e.Y36(v._W),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-fixed-list"]],decls:21,vars:16,consts:[[1,"page-card"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"title"],[1,"d-flex","gap-2","align-items-center"],["class","dropdown",4,"hasPermissions"],[3,"text","click"],["text","new",3,"click"],["class","import",4,"ngIf"],[1,"d-flex","justify-content-between","my-3"],[3,"SortConfig"],["sort",""],[1,"d-flex","g-2"],[3,"config"],["filter",""],[1,"table"],[3,"tableConfig","pagination","filter","sort"],[1,"d-flex","align-items-center","justify-content-center"],["pagination",""],[1,"dropdown"],["type","button","id","dropdownMenuButton1","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-cancel","dropdown-toggle"],["aria-labelledby","dropdownMenuButton1",1,"dropdown-menu"],[1,"pointer","dropdown-item",3,"click"],[1,"import"],[4,"ngFor","ngForOf"],[3,"multiple","accept","label","onValueChange"],[1,"d-flex","gap-2","align-items-center","mt-3"],[3,"text","loading","click"],[1,"fa-solid","fa-check","px-2"],[1,"btn-cancel",3,"text","click"],[1,"text-error"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3),e.YNc(6,Y,13,13,"div",4),e.TgZ(7,"app-button",5),e.NdJ("click",function(){return o.openSectionToImport()}),e.qZA(),e.TgZ(8,"app-button",6),e.NdJ("click",function(){return o.openDialogToCreate()}),e.qZA()()(),e.YNc(9,W,7,7,"div",7),e.TgZ(10,"div",8),e._UZ(11,"ukt-sort",9,10),e.TgZ(13,"div",11),e._UZ(14,"ukt-filter",12,13),e.qZA()(),e.TgZ(16,"div",14),e._UZ(17,"app-table",15),e.qZA(),e.TgZ(18,"div",16),e._UZ(19,"ukt-pagination",null,17),e.qZA()()),2&t){const l=e.MAs(12),x=e.MAs(15),m=e.MAs(20);e.xp6(3),e.Oqu(e.lcZ(4,12,"list_all_of_fixed_asset")),e.xp6(3),e.Q6J("hasPermissions",e.VKq(14,V,o.permissions.list)),e.xp6(1),e.Tol("btn-cancel"),e.Q6J("text","import"),e.xp6(2),e.Q6J("ngIf",o.showImportForm),e.xp6(2),e.Q6J("SortConfig",o.sortConfig),e.xp6(3),e.Q6J("config",o.financialFilterConfig),e.xp6(3),e.Q6J("tableConfig",o.tableConfig)("pagination",m)("filter",x)("sort",l)}},dependencies:[r.sg,r.O5,S.z,P.a,Q.Y,B.Q,F.r,G.z,w.x,r.rS,C.X$],styles:[".dropdown[_ngcontent-%COMP%]{background-color:transparent!important}.dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent!important;border:1px solid var(--mainColor);font-size:1.5rem;padding:6px}.dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:1.5rem}.import[_ngcontent-%COMP%]{padding:20px;border:2px solid var(--mainColor);border-radius:8px;margin:10px 0}"]}),i})()}];let K=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[Z.Bz.forChild(k),Z.Bz]}),i})();var R=n(1471),X=n(9293),z=n(9624),H=n(4413),$=n(2115),ee=n(1383),te=n(1890),ie=n(1019),oe=n(8096);let ne=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[r.ez,K,ee.m,C.aw,R.X,X.Q,z.U,$.u,H.e,te.f,ie.i,oe.J,C.aw]}),i})()},4896:(L,T,n)=>{n.d(T,{Y:()=>b});var r=n(9291),Z=n(67),c=n(6223),f=n(6814),p=n(3999);function _(d,g){1&d&&r._UZ(0,"i",5)}function u(d,g){if(1&d&&(r.TgZ(0,"label"),r._uU(1),r.ALo(2,"titlecase"),r.ALo(3,"translate"),r.TgZ(4,"span",3),r.YNc(5,_,1,0,"i",4),r.qZA()()),2&d){const e=r.oxw();r.xp6(1),r.hij("",r.lcZ(2,2,r.lcZ(3,4,e.label))," "),r.xp6(4),r.Q6J("ngIf",e.control&&(null==e.control.errors?null:e.control.errors.required))}}let b=(()=>{class d extends Z.t{constructor(e){super(),this.formGroupDirective=e,this.uploadedFiles=[],this.multiple=!0,this.label="Upload",this.accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx",this.onValueChange=new r.vpe}onFileSelected(e){this.onValueChange.emit(e)}onUpload(e){for(let s of e.files)this.uploadedFiles.push(s)}}return d.\u0275fac=function(e){return new(e||d)(r.Y36(c.sg,8))},d.\u0275cmp=r.Xpm({type:d,selectors:[["app-file-upload"]],inputs:{value:"value",multiple:"multiple",label:"label",accept:"accept"},outputs:{onValueChange:"onValueChange"},features:[r._Bn([{provide:c.JU,useExisting:d,multi:!0},{provide:c.Cf,useExisting:d,multi:!0}]),r.qOj],decls:3,vars:4,consts:[[1,"main"],[4,"ngIf"],["type","file","id","file",1,"form-control",3,"multiple","ngModel","accept","ngModelChange","change"],[1,"required-aster"],["class","fa-solid fa-asterisk",4,"ngIf"],[1,"fa-solid","fa-asterisk"]],template:function(e,s){1&e&&(r.TgZ(0,"div",0),r.YNc(1,u,6,6,"label",1),r.TgZ(2,"input",2),r.NdJ("ngModelChange",function(h){return s.value=h})("change",function(h){return s.onFileSelected(h)}),r.qZA()()),2&e&&(r.xp6(1),r.Q6J("ngIf",s.label),r.xp6(1),r.Q6J("multiple",s.multiple)("ngModel",s.value)("accept",s.accept))},dependencies:[f.O5,c.Fj,c.JJ,c.On,f.rS,p.X$],styles:[".main[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px dashed #7ca0c5;padding:7px;font-size:14px}"]}),d})()}}]);